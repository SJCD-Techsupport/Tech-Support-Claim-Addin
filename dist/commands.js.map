{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-react-js/./node_modules/es6-promise/dist/es6-promise.js","webpack://office-addin-taskpane-react-js/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane-react-js/webpack/bootstrap","webpack://office-addin-taskpane-react-js/webpack/runtime/compat get default export","webpack://office-addin-taskpane-react-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-react-js/webpack/runtime/global","webpack://office-addin-taskpane-react-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-react-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-react-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/RequestMethod.js","webpack://office-addin-taskpane-react-js/./node_modules/tslib/tslib.es6.mjs","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/content/BatchRequestContent.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/Constants.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphClientError.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphRequestUtil.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/MiddlewareControl.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/MiddlewareUtil.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/options/AuthenticationHandlerOptions.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/options/TelemetryHandlerOptions.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/AuthenticationHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/options/RetryHandlerOptions.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/options/ChaosStrategy.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/ResponseType.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/RetryHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/options/RedirectHandlerOptions.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/RedirectHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/TelemetryHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphResponseHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/FileUploadTask/Range.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/FileUploadTask/UploadResult.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/LargeFileUploadTask.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/FileUploadTask/FileObjectClasses/FileUpload.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/OneDriveLargeFileUploadTask.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/tasks/OneDriveLargeFileUploadTaskUtil.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/CustomAuthenticationProvider.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphError.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphErrorHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/GraphRequest.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/HTTPClient.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/middleware/HTTPMessageHandler.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/HTTPClientFactory.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/Client.js","webpack://office-addin-taskpane-react-js/./node_modules/@microsoft/microsoft-graph-client/lib/es/src/ValidatePolyFilling.js","webpack://office-addin-taskpane-react-js/./src/commands/commands.js","webpack://office-addin-taskpane-react-js/./src/commands/commands.html"],"sourcesContent":["/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    var then$$1 = void 0;\n    try {\n      then$$1 = value.then;\n    } catch (error) {\n      reject(promise, error);\n      return;\n    }\n    handleMaybeThenable(promise, value, then$$1);\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = true;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n    } catch (e) {\n      succeeded = false;\n      error = e;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (succeeded === false) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = void 0;\n      var error = void 0;\n      var didError = false;\n      try {\n        _then = entry.then;\n      } catch (e) {\n        didError = true;\n        error = e;\n      }\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        if (didError) {\n          reject(promise, error);\n        } else {\n          handleMaybeThenable(promise, entry, _then);\n        }\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n//# sourceMappingURL=es6-promise.map\n","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = String(url.__esModule ? url.default : url);\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t217: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @enum\n * Enum for RequestMethods\n * @property {string} GET - The get request type\n * @property {string} PATCH - The patch request type\n * @property {string} POST - The post request type\n * @property {string} PUT - The put request type\n * @property {string} DELETE - The delete request type\n */\nexport var RequestMethod;\n(function (RequestMethod) {\n    RequestMethod[\"GET\"] = \"GET\";\n    RequestMethod[\"PATCH\"] = \"PATCH\";\n    RequestMethod[\"POST\"] = \"POST\";\n    RequestMethod[\"PUT\"] = \"PUT\";\n    RequestMethod[\"DELETE\"] = \"DELETE\";\n})(RequestMethod || (RequestMethod = {}));\n//# sourceMappingURL=RequestMethod.js.map","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module BatchRequestContent\n */\nimport { RequestMethod } from \"../RequestMethod\";\n/**\n * @class\n * Class for handling BatchRequestContent\n */\nexport class BatchRequestContent {\n    /**\n     * @private\n     * @static\n     * Validates the dependency chain of the requests\n     *\n     * Note:\n     * Individual requests can depend on other individual requests. Currently, requests can only depend on a single other request, and must follow one of these three patterns:\n     * 1. Parallel - no individual request states a dependency in the dependsOn property.\n     * 2. Serial - all individual requests depend on the previous individual request.\n     * 3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.\n     * As JSON batching matures, these limitations will be removed.\n     * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}\n     *\n     * @param {Map<string, BatchRequestStep>} requests - The map of requests.\n     * @returns The boolean indicating the validation status\n     */\n    static validateDependencies(requests) {\n        const isParallel = (reqs) => {\n            const iterator = reqs.entries();\n            let cur = iterator.next();\n            while (!cur.done) {\n                const curReq = cur.value[1];\n                if (curReq.dependsOn !== undefined && curReq.dependsOn.length > 0) {\n                    return false;\n                }\n                cur = iterator.next();\n            }\n            return true;\n        };\n        const isSerial = (reqs) => {\n            const iterator = reqs.entries();\n            let cur = iterator.next();\n            const firstRequest = cur.value[1];\n            if (firstRequest.dependsOn !== undefined && firstRequest.dependsOn.length > 0) {\n                return false;\n            }\n            let prev = cur;\n            cur = iterator.next();\n            while (!cur.done) {\n                const curReq = cur.value[1];\n                if (curReq.dependsOn === undefined || curReq.dependsOn.length !== 1 || curReq.dependsOn[0] !== prev.value[1].id) {\n                    return false;\n                }\n                prev = cur;\n                cur = iterator.next();\n            }\n            return true;\n        };\n        const isSame = (reqs) => {\n            const iterator = reqs.entries();\n            let cur = iterator.next();\n            const firstRequest = cur.value[1];\n            let dependencyId;\n            if (firstRequest.dependsOn === undefined || firstRequest.dependsOn.length === 0) {\n                dependencyId = firstRequest.id;\n            }\n            else {\n                if (firstRequest.dependsOn.length === 1) {\n                    const fDependencyId = firstRequest.dependsOn[0];\n                    if (fDependencyId !== firstRequest.id && reqs.has(fDependencyId)) {\n                        dependencyId = fDependencyId;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                else {\n                    return false;\n                }\n            }\n            cur = iterator.next();\n            while (!cur.done) {\n                const curReq = cur.value[1];\n                if ((curReq.dependsOn === undefined || curReq.dependsOn.length === 0) && dependencyId !== curReq.id) {\n                    return false;\n                }\n                if (curReq.dependsOn !== undefined && curReq.dependsOn.length !== 0) {\n                    if (curReq.dependsOn.length === 1 && (curReq.id === dependencyId || curReq.dependsOn[0] !== dependencyId)) {\n                        return false;\n                    }\n                    if (curReq.dependsOn.length > 1) {\n                        return false;\n                    }\n                }\n                cur = iterator.next();\n            }\n            return true;\n        };\n        if (requests.size === 0) {\n            const error = new Error(\"Empty requests map, Please provide at least one request.\");\n            error.name = \"Empty Requests Error\";\n            throw error;\n        }\n        return isParallel(requests) || isSerial(requests) || isSame(requests);\n    }\n    /**\n     * @private\n     * @static\n     * @async\n     * Converts Request Object instance to a JSON\n     * @param {IsomorphicRequest} request - The IsomorphicRequest Object instance\n     * @returns A promise that resolves to JSON representation of a request\n     */\n    static getRequestData(request) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const requestData = {\n                url: \"\",\n            };\n            const hasHttpRegex = new RegExp(\"^https?://\");\n            // Stripping off hostname, port and url scheme\n            requestData.url = hasHttpRegex.test(request.url) ? \"/\" + request.url.split(/.*?\\/\\/.*?\\//)[1] : request.url;\n            requestData.method = request.method;\n            const headers = {};\n            request.headers.forEach((value, key) => {\n                headers[key] = value;\n            });\n            if (Object.keys(headers).length) {\n                requestData.headers = headers;\n            }\n            if (request.method === RequestMethod.PATCH || request.method === RequestMethod.POST || request.method === RequestMethod.PUT) {\n                requestData.body = yield BatchRequestContent.getRequestBody(request);\n            }\n            /**\n             * TODO: Check any other property needs to be used from the Request object and add them\n             */\n            return requestData;\n        });\n    }\n    /**\n     * @private\n     * @static\n     * @async\n     * Gets the body of a Request object instance\n     * @param {IsomorphicRequest} request - The IsomorphicRequest object instance\n     * @returns The Promise that resolves to a body value of a Request\n     */\n    static getRequestBody(request) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let bodyParsed = false;\n            let body;\n            try {\n                const cloneReq = request.clone();\n                body = yield cloneReq.json();\n                bodyParsed = true;\n            }\n            catch (e) {\n                //TODO- Handle empty catches\n            }\n            if (!bodyParsed) {\n                try {\n                    if (typeof Blob !== \"undefined\") {\n                        const blob = yield request.blob();\n                        const reader = new FileReader();\n                        body = yield new Promise((resolve) => {\n                            reader.addEventListener(\"load\", () => {\n                                const dataURL = reader.result;\n                                /**\n                                 * Some valid dataURL schemes:\n                                 *  1. data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh\n                                 *  2. data:text/plain;charset=UTF-8;page=21,the%20data:1234,5678\n                                 *  3. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n                                 *  4. data:image/png,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n                                 *  5. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\n                                 * @see Syntax {@link https://en.wikipedia.org/wiki/Data_URI_scheme} for more\n                                 */\n                                const regex = new RegExp(\"^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$\");\n                                const segments = regex.exec(dataURL);\n                                resolve(segments[4]);\n                            }, false);\n                            reader.readAsDataURL(blob);\n                        });\n                    }\n                    else if (typeof Buffer !== \"undefined\") {\n                        const buffer = yield request.buffer();\n                        body = buffer.toString(\"base64\");\n                    }\n                    bodyParsed = true;\n                }\n                catch (e) {\n                    // TODO-Handle empty catches\n                }\n            }\n            return body;\n        });\n    }\n    /**\n     * @public\n     * @constructor\n     * Constructs a BatchRequestContent instance\n     * @param {BatchRequestStep[]} [requests] - Array of requests value\n     * @returns An instance of a BatchRequestContent\n     */\n    constructor(requests) {\n        this.requests = new Map();\n        if (typeof requests !== \"undefined\") {\n            const limit = BatchRequestContent.requestLimit;\n            if (requests.length > limit) {\n                const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);\n                error.name = \"Limit Exceeded Error\";\n                throw error;\n            }\n            for (const req of requests) {\n                this.addRequest(req);\n            }\n        }\n    }\n    /**\n     * @public\n     * Adds a request to the batch request content\n     * @param {BatchRequestStep} request - The request value\n     * @returns The id of the added request\n     */\n    addRequest(request) {\n        const limit = BatchRequestContent.requestLimit;\n        if (request.id === \"\") {\n            const error = new Error(`Id for a request is empty, Please provide an unique id`);\n            error.name = \"Empty Id For Request\";\n            throw error;\n        }\n        if (this.requests.size === limit) {\n            const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);\n            error.name = \"Limit Exceeded Error\";\n            throw error;\n        }\n        if (this.requests.has(request.id)) {\n            const error = new Error(`Adding request with duplicate id ${request.id}, Make the id of the requests unique`);\n            error.name = \"Duplicate RequestId Error\";\n            throw error;\n        }\n        this.requests.set(request.id, request);\n        return request.id;\n    }\n    /**\n     * @public\n     * Removes request from the batch payload and its dependencies from all dependents\n     * @param {string} requestId - The id of a request that needs to be removed\n     * @returns The boolean indicating removed status\n     */\n    removeRequest(requestId) {\n        const deleteStatus = this.requests.delete(requestId);\n        const iterator = this.requests.entries();\n        let cur = iterator.next();\n        /**\n         * Removing dependencies where this request is present as a dependency\n         */\n        while (!cur.done) {\n            const dependencies = cur.value[1].dependsOn;\n            if (typeof dependencies !== \"undefined\") {\n                const index = dependencies.indexOf(requestId);\n                if (index !== -1) {\n                    dependencies.splice(index, 1);\n                }\n                if (dependencies.length === 0) {\n                    delete cur.value[1].dependsOn;\n                }\n            }\n            cur = iterator.next();\n        }\n        return deleteStatus;\n    }\n    /**\n     * @public\n     * @async\n     * Serialize content from BatchRequestContent instance\n     * @returns The body content to make batch request\n     */\n    getContent() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const requests = [];\n            const requestBody = {\n                requests,\n            };\n            const iterator = this.requests.entries();\n            let cur = iterator.next();\n            if (cur.done) {\n                const error = new Error(\"No requests added yet, Please add at least one request.\");\n                error.name = \"Empty Payload\";\n                throw error;\n            }\n            if (!BatchRequestContent.validateDependencies(this.requests)) {\n                const error = new Error(`Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);\n                error.name = \"Invalid Dependency\";\n                throw error;\n            }\n            while (!cur.done) {\n                const requestStep = cur.value[1];\n                const batchRequestData = (yield BatchRequestContent.getRequestData(requestStep.request));\n                /**\n                 * @see{@https://tools.ietf.org/html/rfc7578#section-4.4}\n                 * TODO- Setting/Defaulting of content-type header to the correct value\n                 * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/json_batching#request-format}\n                 */\n                if (batchRequestData.body !== undefined && (batchRequestData.headers === undefined || batchRequestData.headers[\"content-type\"] === undefined)) {\n                    const error = new Error(`Content-type header is not mentioned for request #${requestStep.id}, For request having body, Content-type header should be mentioned`);\n                    error.name = \"Invalid Content-type header\";\n                    throw error;\n                }\n                batchRequestData.id = requestStep.id;\n                if (requestStep.dependsOn !== undefined && requestStep.dependsOn.length > 0) {\n                    batchRequestData.dependsOn = requestStep.dependsOn;\n                }\n                requests.push(batchRequestData);\n                cur = iterator.next();\n            }\n            requestBody.requests = requests;\n            return requestBody;\n        });\n    }\n    /**\n     * @public\n     * Adds a dependency for a given dependent request\n     * @param {string} dependentId - The id of the dependent request\n     * @param {string} [dependencyId] - The id of the dependency request, if not specified the preceding request will be considered as a dependency\n     * @returns Nothing\n     */\n    addDependency(dependentId, dependencyId) {\n        if (!this.requests.has(dependentId)) {\n            const error = new Error(`Dependent ${dependentId} does not exists, Please check the id`);\n            error.name = \"Invalid Dependent\";\n            throw error;\n        }\n        if (typeof dependencyId !== \"undefined\" && !this.requests.has(dependencyId)) {\n            const error = new Error(`Dependency ${dependencyId} does not exists, Please check the id`);\n            error.name = \"Invalid Dependency\";\n            throw error;\n        }\n        if (typeof dependencyId !== \"undefined\") {\n            const dependent = this.requests.get(dependentId);\n            if (dependent.dependsOn === undefined) {\n                dependent.dependsOn = [];\n            }\n            if (dependent.dependsOn.indexOf(dependencyId) !== -1) {\n                const error = new Error(`Dependency ${dependencyId} is already added for the request ${dependentId}`);\n                error.name = \"Duplicate Dependency\";\n                throw error;\n            }\n            dependent.dependsOn.push(dependencyId);\n        }\n        else {\n            const iterator = this.requests.entries();\n            let prev;\n            let cur = iterator.next();\n            while (!cur.done && cur.value[1].id !== dependentId) {\n                prev = cur;\n                cur = iterator.next();\n            }\n            if (typeof prev !== \"undefined\") {\n                const dId = prev.value[0];\n                if (cur.value[1].dependsOn === undefined) {\n                    cur.value[1].dependsOn = [];\n                }\n                if (cur.value[1].dependsOn.indexOf(dId) !== -1) {\n                    const error = new Error(`Dependency ${dId} is already added for the request ${dependentId}`);\n                    error.name = \"Duplicate Dependency\";\n                    throw error;\n                }\n                cur.value[1].dependsOn.push(dId);\n            }\n            else {\n                const error = new Error(`Can't add dependency ${dependencyId}, There is only a dependent request in the batch`);\n                error.name = \"Invalid Dependency Addition\";\n                throw error;\n            }\n        }\n    }\n    /**\n     * @public\n     * Removes a dependency for a given dependent request id\n     * @param {string} dependentId - The id of the dependent request\n     * @param {string} [dependencyId] - The id of the dependency request, if not specified will remove all the dependencies of that request\n     * @returns The boolean indicating removed status\n     */\n    removeDependency(dependentId, dependencyId) {\n        const request = this.requests.get(dependentId);\n        if (typeof request === \"undefined\" || request.dependsOn === undefined || request.dependsOn.length === 0) {\n            return false;\n        }\n        if (typeof dependencyId !== \"undefined\") {\n            const index = request.dependsOn.indexOf(dependencyId);\n            if (index === -1) {\n                return false;\n            }\n            request.dependsOn.splice(index, 1);\n            return true;\n        }\n        else {\n            delete request.dependsOn;\n            return true;\n        }\n    }\n}\n/**\n * @private\n * @static\n * Limit for number of requests {@link - https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}\n */\nBatchRequestContent.requestLimit = 20;\n//# sourceMappingURL=BatchRequestContent.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module Constants\n */\n/**\n * @constant\n * A Default API endpoint version for a request\n */\nexport const GRAPH_API_VERSION = \"v1.0\";\n/**\n * @constant\n * A Default base url for a request\n */\nexport const GRAPH_BASE_URL = \"https://graph.microsoft.com/\";\n/**\n * To hold list of the service root endpoints for Microsoft Graph and Graph Explorer for each national cloud.\n * Set(iterable:Object) is not supported in Internet Explorer. The consumer is recommended to use a suitable polyfill.\n */\nexport const GRAPH_URLS = new Set([\"graph.microsoft.com\", \"graph.microsoft.us\", \"dod-graph.microsoft.us\", \"graph.microsoft.de\", \"microsoftgraph.chinacloudapi.cn\", \"canary.graph.microsoft.com\"]);\n//# sourceMappingURL=Constants.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module GraphClientError\n */\n/**\n * @class\n * Create GraphClientError object to handle client-side errors\n * encountered within the JavaScript Client SDK.\n * Whereas GraphError Class should be used to handle errors in the response from the Graph API.\n */\nexport class GraphClientError extends Error {\n    /**\n     * @public\n     * @static\n     * @async\n     * To set the GraphClientError object\n     * @param {any} error - The error returned encountered by the Graph JavaScript Client SDK while processing request\n     * @returns GraphClientError object set to the error passed\n     */\n    static setGraphClientError(error) {\n        let graphClientError;\n        if (error instanceof Error) {\n            graphClientError = error;\n        }\n        else {\n            graphClientError = new GraphClientError();\n            graphClientError.customError = error;\n        }\n        return graphClientError;\n    }\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of GraphClientError\n     * @param {string} message? - Error message\n     * @returns An instance of GraphClientError\n     */\n    constructor(message) {\n        super(message);\n        Object.setPrototypeOf(this, GraphClientError.prototype);\n    }\n}\n//# sourceMappingURL=GraphClientError.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module GraphRequestUtil\n */\nimport { GRAPH_URLS } from \"./Constants\";\nimport { GraphClientError } from \"./GraphClientError\";\n/**\n * To hold list of OData query params\n */\nexport const oDataQueryNames = [\"$select\", \"$expand\", \"$orderby\", \"$filter\", \"$top\", \"$skip\", \"$skipToken\", \"$count\"];\n/**\n * To construct the URL by appending the segments with \"/\"\n * @param {string[]} urlSegments - The array of strings\n * @returns The constructed URL string\n */\nexport const urlJoin = (urlSegments) => {\n    const removePostSlash = (s) => s.replace(/\\/+$/, \"\");\n    const removePreSlash = (s) => s.replace(/^\\/+/, \"\");\n    const joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join(\"/\");\n    const parts = Array.prototype.slice.call(urlSegments);\n    return parts.reduce(joiner);\n};\n/**\n * Serializes the content\n * @param {any} content - The content value that needs to be serialized\n * @returns The serialized content\n *\n * Note:\n * This conversion is required due to the following reasons:\n * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.\n * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.\n * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.\n * If the data received is in JSON format, `serializeContent` converts the JSON to string.\n */\nexport const serializeContent = (content) => {\n    const className = content && content.constructor && content.constructor.name;\n    if (className === \"Buffer\" || className === \"Blob\" || className === \"File\" || className === \"FormData\" || typeof content === \"string\") {\n        return content;\n    }\n    if (className === \"ArrayBuffer\") {\n        content = Buffer.from(content);\n    }\n    else if (className === \"Int8Array\" || className === \"Int16Array\" || className === \"Int32Array\" || className === \"Uint8Array\" || className === \"Uint16Array\" || className === \"Uint32Array\" || className === \"Uint8ClampedArray\" || className === \"Float32Array\" || className === \"Float64Array\" || className === \"DataView\") {\n        content = Buffer.from(content.buffer);\n    }\n    else {\n        try {\n            content = JSON.stringify(content);\n        }\n        catch (error) {\n            throw new Error(\"Unable to stringify the content\");\n        }\n    }\n    return content;\n};\n/**\n * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.\n * @param {string} url - The url to be verified\n * @returns {boolean} - Returns true if the url is a Graph URL\n */\nexport const isGraphURL = (url) => {\n    return isValidEndpoint(url);\n};\n/**\n * Checks if the url is for one of the custom hosts provided during client initialization\n * @param {string} url - The url to be verified\n * @param {Set} customHosts - The url to be verified\n * @returns {boolean} - Returns true if the url is a for a custom host\n */\nexport const isCustomHost = (url, customHosts) => {\n    customHosts.forEach((host) => isCustomHostValid(host));\n    return isValidEndpoint(url, customHosts);\n};\n/**\n * Checks if the url is for one of the provided hosts.\n * @param {string} url - The url to be verified\n * @param {Set<string>} allowedHosts - A set of hosts.\n * @returns {boolean} - Returns true is for one of the provided endpoints.\n */\nconst isValidEndpoint = (url, allowedHosts = GRAPH_URLS) => {\n    // Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}\n    // Valid Graph URL example - https://graph.microsoft.com/v1.0/\n    url = url.toLowerCase();\n    if (url.indexOf(\"https://\") !== -1) {\n        url = url.replace(\"https://\", \"\");\n        // Find where the host ends\n        const startofPortNoPos = url.indexOf(\":\");\n        const endOfHostStrPos = url.indexOf(\"/\");\n        let hostName = \"\";\n        if (endOfHostStrPos !== -1) {\n            if (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {\n                hostName = url.substring(0, startofPortNoPos);\n                return allowedHosts.has(hostName);\n            }\n            // Parse out the host\n            hostName = url.substring(0, endOfHostStrPos);\n            return allowedHosts.has(hostName);\n        }\n    }\n    return false;\n};\n/**\n * Throws error if the string is not a valid host/hostname and contains other url parts.\n * @param {string} host - The host to be verified\n */\nconst isCustomHostValid = (host) => {\n    if (host.indexOf(\"/\") !== -1) {\n        throw new GraphClientError(\"Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`\");\n    }\n};\n//# sourceMappingURL=GraphRequestUtil.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @class\n * Class representing MiddlewareControl\n */\nexport class MiddlewareControl {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of MiddlewareControl\n     * @param {MiddlewareOptions[]} [middlewareOptions = []] - The array of middlewareOptions\n     * @returns The instance of MiddlewareControl\n     */\n    constructor(middlewareOptions = []) {\n        this.middlewareOptions = new Map();\n        for (const option of middlewareOptions) {\n            const fn = option.constructor;\n            this.middlewareOptions.set(fn, option);\n        }\n    }\n    /**\n     * @public\n     * To get the middleware option using the class of the option\n     * @param {Function} fn - The class of the strongly typed option class\n     * @returns The middleware option\n     * @example\n     * // if you wanted to return the middleware option associated with this class (MiddlewareControl)\n     * // call this function like this:\n     * getMiddlewareOptions(MiddlewareControl)\n     */\n    getMiddlewareOptions(fn) {\n        return this.middlewareOptions.get(fn);\n    }\n    /**\n     * @public\n     * To set the middleware options using the class of the option\n     * @param {Function} fn - The class of the strongly typed option class\n     * @param {MiddlewareOptions} option - The strongly typed middleware option\n     * @returns nothing\n     */\n    setMiddlewareOptions(fn, option) {\n        this.middlewareOptions.set(fn, option);\n    }\n}\n//# sourceMappingURL=MiddlewareControl.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @constant\n * To generate the UUID\n * @returns The UUID string\n */\nexport const generateUUID = () => {\n    let uuid = \"\";\n    for (let j = 0; j < 32; j++) {\n        if (j === 8 || j === 12 || j === 16 || j === 20) {\n            uuid += \"-\";\n        }\n        uuid += Math.floor(Math.random() * 16).toString(16);\n    }\n    return uuid;\n};\n/**\n * @constant\n * To get the request header from the request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @returns A header value for the given key from the request\n */\nexport const getRequestHeader = (request, options, key) => {\n    let value = null;\n    if (typeof Request !== \"undefined\" && request instanceof Request) {\n        value = request.headers.get(key);\n    }\n    else if (typeof options !== \"undefined\" && options.headers !== undefined) {\n        if (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n            value = options.headers.get(key);\n        }\n        else if (options.headers instanceof Array) {\n            const headers = options.headers;\n            for (let i = 0, l = headers.length; i < l; i++) {\n                if (headers[i][0] === key) {\n                    value = headers[i][1];\n                    break;\n                }\n            }\n        }\n        else if (options.headers[key] !== undefined) {\n            value = options.headers[key];\n        }\n    }\n    return value;\n};\n/**\n * @constant\n * To set the header value to the given request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @param {string } value - The header value string\n * @returns Nothing\n */\nexport const setRequestHeader = (request, options, key, value) => {\n    if (typeof Request !== \"undefined\" && request instanceof Request) {\n        request.headers.set(key, value);\n    }\n    else if (typeof options !== \"undefined\") {\n        if (options.headers === undefined) {\n            options.headers = new Headers({\n                [key]: value,\n            });\n        }\n        else {\n            if (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n                options.headers.set(key, value);\n            }\n            else if (options.headers instanceof Array) {\n                let i = 0;\n                const l = options.headers.length;\n                for (; i < l; i++) {\n                    const header = options.headers[i];\n                    if (header[0] === key) {\n                        header[1] = value;\n                        break;\n                    }\n                }\n                if (i === l) {\n                    options.headers.push([key, value]);\n                }\n            }\n            else {\n                Object.assign(options.headers, { [key]: value });\n            }\n        }\n    }\n};\n/**\n * @constant\n * To append the header value to the given request\n * @param {RequestInfo} request - The request object or the url string\n * @param {FetchOptions|undefined} options - The request options object\n * @param {string} key - The header key string\n * @param {string } value - The header value string\n * @returns Nothing\n */\nexport const appendRequestHeader = (request, options, key, value) => {\n    if (typeof Request !== \"undefined\" && request instanceof Request) {\n        request.headers.append(key, value);\n    }\n    else if (typeof options !== \"undefined\") {\n        if (options.headers === undefined) {\n            options.headers = new Headers({\n                [key]: value,\n            });\n        }\n        else {\n            if (typeof Headers !== \"undefined\" && options.headers instanceof Headers) {\n                options.headers.append(key, value);\n            }\n            else if (options.headers instanceof Array) {\n                options.headers.push([key, value]);\n            }\n            else if (options.headers === undefined) {\n                options.headers = { [key]: value };\n            }\n            else if (options.headers[key] === undefined) {\n                options.headers[key] = value;\n            }\n            else {\n                options.headers[key] += `, ${value}`;\n            }\n        }\n    }\n};\n/**\n * @constant\n * To clone the request with the new url\n * @param {string} url - The new url string\n * @param {Request} request - The request object\n * @returns A promise that resolves to request object\n */\nexport const cloneRequestWithNewUrl = (newUrl, request) => __awaiter(void 0, void 0, void 0, function* () {\n    const body = request.headers.get(\"Content-Type\") ? yield request.blob() : yield Promise.resolve(undefined);\n    const { method, headers, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal } = request;\n    return new Request(newUrl, { method, headers, body, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal });\n});\n//# sourceMappingURL=MiddlewareUtil.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @class\n * @implements MiddlewareOptions\n * Class representing AuthenticationHandlerOptions\n */\nexport class AuthenticationHandlerOptions {\n    /**\n     * @public\n     * @constructor\n     * To create an instance of AuthenticationHandlerOptions\n     * @param {AuthenticationProvider} [authenticationProvider] - The authentication provider instance\n     * @param {AuthenticationProviderOptions} [authenticationProviderOptions] - The authentication provider options instance\n     * @returns An instance of AuthenticationHandlerOptions\n     */\n    constructor(authenticationProvider, authenticationProviderOptions) {\n        this.authenticationProvider = authenticationProvider;\n        this.authenticationProviderOptions = authenticationProviderOptions;\n    }\n}\n//# sourceMappingURL=AuthenticationHandlerOptions.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { MiddlewareControl } from \"../MiddlewareControl\";\n/**\n * @enum\n * @property {number} NONE - The hexadecimal flag value for nothing enabled\n * @property {number} REDIRECT_HANDLER_ENABLED - The hexadecimal flag value for redirect handler enabled\n * @property {number} RETRY_HANDLER_ENABLED - The hexadecimal flag value for retry handler enabled\n * @property {number} AUTHENTICATION_HANDLER_ENABLED - The hexadecimal flag value for the authentication handler enabled\n */\nexport var FeatureUsageFlag;\n(function (FeatureUsageFlag) {\n    /* eslint-disable  @typescript-eslint/naming-convention */\n    FeatureUsageFlag[FeatureUsageFlag[\"NONE\"] = 0] = \"NONE\";\n    FeatureUsageFlag[FeatureUsageFlag[\"REDIRECT_HANDLER_ENABLED\"] = 1] = \"REDIRECT_HANDLER_ENABLED\";\n    FeatureUsageFlag[FeatureUsageFlag[\"RETRY_HANDLER_ENABLED\"] = 2] = \"RETRY_HANDLER_ENABLED\";\n    FeatureUsageFlag[FeatureUsageFlag[\"AUTHENTICATION_HANDLER_ENABLED\"] = 4] = \"AUTHENTICATION_HANDLER_ENABLED\";\n    /* eslint-enable  @typescript-eslint/naming-convention */\n})(FeatureUsageFlag || (FeatureUsageFlag = {}));\n/**\n * @class\n * @implements MiddlewareOptions\n * Class for TelemetryHandlerOptions\n */\nexport class TelemetryHandlerOptions {\n    constructor() {\n        /**\n         * @private\n         * A member to hold the OR of feature usage flags\n         */\n        this.featureUsage = FeatureUsageFlag.NONE;\n    }\n    /**\n     * @public\n     * @static\n     * To update the feature usage in the context object\n     * @param {Context} context - The request context object containing middleware options\n     * @param {FeatureUsageFlag} flag - The flag value\n     * @returns nothing\n     */\n    static updateFeatureUsageFlag(context, flag) {\n        let options;\n        if (context.middlewareControl instanceof MiddlewareControl) {\n            options = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions);\n        }\n        else {\n            context.middlewareControl = new MiddlewareControl();\n        }\n        if (typeof options === \"undefined\") {\n            options = new TelemetryHandlerOptions();\n            context.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions, options);\n        }\n        options.setFeatureUsage(flag);\n    }\n    /**\n     * @private\n     * To set the feature usage flag\n     * @param {FeatureUsageFlag} flag - The flag value\n     * @returns nothing\n     */\n    setFeatureUsage(flag) {\n        this.featureUsage = this.featureUsage | flag;\n    }\n    /**\n     * @public\n     * To get the feature usage\n     * @returns A feature usage flag as hexadecimal string\n     */\n    getFeatureUsage() {\n        return this.featureUsage.toString(16);\n    }\n}\n//# sourceMappingURL=TelemetryHandlerOptions.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module AuthenticationHandler\n */\nimport { isCustomHost, isGraphURL } from \"../GraphRequestUtil\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { appendRequestHeader } from \"./MiddlewareUtil\";\nimport { AuthenticationHandlerOptions } from \"./options/AuthenticationHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n/**\n * @class\n * @implements Middleware\n * Class representing AuthenticationHandler\n */\nexport class AuthenticationHandler {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of AuthenticationHandler\n     * @param {AuthenticationProvider} authenticationProvider - The authentication provider for the authentication handler\n     */\n    constructor(authenticationProvider) {\n        this.authenticationProvider = authenticationProvider;\n    }\n    /**\n     * @public\n     * @async\n     * To execute the current middleware\n     * @param {Context} context - The context object of the request\n     * @returns A Promise that resolves to nothing\n     */\n    execute(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = typeof context.request === \"string\" ? context.request : context.request.url;\n            if (isGraphURL(url) || (context.customHosts && isCustomHost(url, context.customHosts))) {\n                let options;\n                if (context.middlewareControl instanceof MiddlewareControl) {\n                    options = context.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions);\n                }\n                let authenticationProvider;\n                let authenticationProviderOptions;\n                if (options) {\n                    authenticationProvider = options.authenticationProvider;\n                    authenticationProviderOptions = options.authenticationProviderOptions;\n                }\n                if (!authenticationProvider) {\n                    authenticationProvider = this.authenticationProvider;\n                }\n                const token = yield authenticationProvider.getAccessToken(authenticationProviderOptions);\n                const bearerKey = `Bearer ${token}`;\n                appendRequestHeader(context.request, context.options, AuthenticationHandler.AUTHORIZATION_HEADER, bearerKey);\n                TelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.AUTHENTICATION_HANDLER_ENABLED);\n            }\n            else {\n                if (context.options.headers) {\n                    delete context.options.headers[AuthenticationHandler.AUTHORIZATION_HEADER];\n                }\n            }\n            return yield this.nextMiddleware.execute(context);\n        });\n    }\n    /**\n     * @public\n     * To set the next middleware in the chain\n     * @param {Middleware} next - The middleware instance\n     * @returns Nothing\n     */\n    setNext(next) {\n        this.nextMiddleware = next;\n    }\n}\n/**\n * @private\n * A member representing the authorization header name\n */\nAuthenticationHandler.AUTHORIZATION_HEADER = \"Authorization\";\n//# sourceMappingURL=AuthenticationHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @class\n * @implements MiddlewareOptions\n * Class for RetryHandlerOptions\n */\nexport class RetryHandlerOptions {\n    /**\n     * @public\n     * @constructor\n     * To create an instance of RetryHandlerOptions\n     * @param {number} [delay = RetryHandlerOptions.DEFAULT_DELAY] - The delay value in seconds\n     * @param {number} [maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES] - The maxRetries value\n     * @param {ShouldRetry} [shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY] - The shouldRetry callback function\n     * @returns An instance of RetryHandlerOptions\n     */\n    constructor(delay = RetryHandlerOptions.DEFAULT_DELAY, maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES, shouldRetry = RetryHandlerOptions.defaultShouldRetry) {\n        if (delay > RetryHandlerOptions.MAX_DELAY && maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {\n            const error = new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);\n            error.name = \"MaxLimitExceeded\";\n            throw error;\n        }\n        else if (delay > RetryHandlerOptions.MAX_DELAY) {\n            const error = new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);\n            error.name = \"MaxLimitExceeded\";\n            throw error;\n        }\n        else if (maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {\n            const error = new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);\n            error.name = \"MaxLimitExceeded\";\n            throw error;\n        }\n        else if (delay < 0 && maxRetries < 0) {\n            const error = new Error(`Delay and MaxRetries should not be negative`);\n            error.name = \"MinExpectationNotMet\";\n            throw error;\n        }\n        else if (delay < 0) {\n            const error = new Error(`Delay should not be negative`);\n            error.name = \"MinExpectationNotMet\";\n            throw error;\n        }\n        else if (maxRetries < 0) {\n            const error = new Error(`MaxRetries should not be negative`);\n            error.name = \"MinExpectationNotMet\";\n            throw error;\n        }\n        this.delay = Math.min(delay, RetryHandlerOptions.MAX_DELAY);\n        this.maxRetries = Math.min(maxRetries, RetryHandlerOptions.MAX_MAX_RETRIES);\n        this.shouldRetry = shouldRetry;\n    }\n    /**\n     * @public\n     * To get the maximum delay\n     * @returns A maximum delay\n     */\n    getMaxDelay() {\n        return RetryHandlerOptions.MAX_DELAY;\n    }\n}\n/**\n * @private\n * @static\n * A member holding default delay value in seconds\n */\nRetryHandlerOptions.DEFAULT_DELAY = 3;\n/**\n * @private\n * @static\n * A member holding default maxRetries value\n */\nRetryHandlerOptions.DEFAULT_MAX_RETRIES = 3;\n/**\n * @private\n * @static\n * A member holding maximum delay value in seconds\n */\nRetryHandlerOptions.MAX_DELAY = 180;\n/**\n * @private\n * @static\n * A member holding maximum maxRetries value\n */\nRetryHandlerOptions.MAX_MAX_RETRIES = 10;\n/**\n * @private\n * A member holding default shouldRetry callback\n */\nRetryHandlerOptions.defaultShouldRetry = () => true;\n//# sourceMappingURL=RetryHandlerOptions.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module ChaosStrategy\n */\n/**\n * Strategy used for Testing Handler\n * @enum\n */\nexport var ChaosStrategy;\n(function (ChaosStrategy) {\n    ChaosStrategy[ChaosStrategy[\"MANUAL\"] = 0] = \"MANUAL\";\n    ChaosStrategy[ChaosStrategy[\"RANDOM\"] = 1] = \"RANDOM\";\n})(ChaosStrategy || (ChaosStrategy = {}));\n//# sourceMappingURL=ChaosStrategy.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @enum\n * Enum for ResponseType values\n * @property {string} ARRAYBUFFER - To download response content as an [ArrayBuffer]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer}\n * @property {string} BLOB - To download content as a [binary/blob] {@link https://developer.mozilla.org/en-US/docs/Web/API/Blob}\n * @property {string} DOCUMENT - This downloads content as a document or stream\n * @property {string} JSON - To download response content as a json\n * @property {string} STREAM - To download response as a [stream]{@link https://nodejs.org/api/stream.html}\n * @property {string} TEXT - For downloading response as a text\n */\nexport var ResponseType;\n(function (ResponseType) {\n    ResponseType[\"ARRAYBUFFER\"] = \"arraybuffer\";\n    ResponseType[\"BLOB\"] = \"blob\";\n    ResponseType[\"DOCUMENT\"] = \"document\";\n    ResponseType[\"JSON\"] = \"json\";\n    ResponseType[\"RAW\"] = \"raw\";\n    ResponseType[\"STREAM\"] = \"stream\";\n    ResponseType[\"TEXT\"] = \"text\";\n})(ResponseType || (ResponseType = {}));\n//# sourceMappingURL=ResponseType.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\nimport { RequestMethod } from \"../RequestMethod\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { getRequestHeader, setRequestHeader } from \"./MiddlewareUtil\";\nimport { RetryHandlerOptions } from \"./options/RetryHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n/**\n * @class\n * @implements Middleware\n * Class for RetryHandler\n */\nexport class RetryHandler {\n    /**\n     * @public\n     * @constructor\n     * To create an instance of RetryHandler\n     * @param {RetryHandlerOptions} [options = new RetryHandlerOptions()] - The retry handler options value\n     * @returns An instance of RetryHandler\n     */\n    constructor(options = new RetryHandlerOptions()) {\n        this.options = options;\n    }\n    /**\n     *\n     * @private\n     * To check whether the response has the retry status code\n     * @param {Response} response - The response object\n     * @returns Whether the response has retry status code or not\n     */\n    isRetry(response) {\n        return RetryHandler.RETRY_STATUS_CODES.indexOf(response.status) !== -1;\n    }\n    /**\n     * @private\n     * To check whether the payload is buffered or not\n     * @param {RequestInfo} request - The url string or the request object value\n     * @param {FetchOptions} options - The options of a request\n     * @returns Whether the payload is buffered or not\n     */\n    isBuffered(request, options) {\n        const method = typeof request === \"string\" ? options.method : request.method;\n        const isPutPatchOrPost = method === RequestMethod.PUT || method === RequestMethod.PATCH || method === RequestMethod.POST;\n        if (isPutPatchOrPost) {\n            const isStream = getRequestHeader(request, options, \"Content-Type\") === \"application/octet-stream\";\n            if (isStream) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * @private\n     * To get the delay for a retry\n     * @param {Response} response - The response object\n     * @param {number} retryAttempts - The current attempt count\n     * @param {number} delay - The delay value in seconds\n     * @returns A delay for a retry\n     */\n    getDelay(response, retryAttempts, delay) {\n        const getRandomness = () => Number(Math.random().toFixed(3));\n        const retryAfter = response.headers !== undefined ? response.headers.get(RetryHandler.RETRY_AFTER_HEADER) : null;\n        let newDelay;\n        if (retryAfter !== null) {\n            if (Number.isNaN(Number(retryAfter))) {\n                newDelay = Math.round((new Date(retryAfter).getTime() - Date.now()) / 1000);\n            }\n            else {\n                newDelay = Number(retryAfter);\n            }\n        }\n        else {\n            // Adding randomness to avoid retrying at a same\n            newDelay = retryAttempts >= 2 ? this.getExponentialBackOffTime(retryAttempts) + delay + getRandomness() : delay + getRandomness();\n        }\n        return Math.min(newDelay, this.options.getMaxDelay() + getRandomness());\n    }\n    /**\n     * @private\n     * To get an exponential back off value\n     * @param {number} attempts - The current attempt count\n     * @returns An exponential back off value\n     */\n    getExponentialBackOffTime(attempts) {\n        return Math.round((1 / 2) * (Math.pow(2, attempts) - 1));\n    }\n    /**\n     * @private\n     * @async\n     * To add delay for the execution\n     * @param {number} delaySeconds - The delay value in seconds\n     * @returns Nothing\n     */\n    sleep(delaySeconds) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const delayMilliseconds = delaySeconds * 1000;\n            return new Promise((resolve) => setTimeout(resolve, delayMilliseconds));\n        });\n    }\n    getOptions(context) {\n        let options;\n        if (context.middlewareControl instanceof MiddlewareControl) {\n            options = context.middlewareControl.getMiddlewareOptions(this.options.constructor);\n        }\n        if (typeof options === \"undefined\") {\n            options = Object.assign(new RetryHandlerOptions(), this.options);\n        }\n        return options;\n    }\n    /**\n     * @private\n     * @async\n     * To execute the middleware with retries\n     * @param {Context} context - The context object\n     * @param {number} retryAttempts - The current attempt count\n     * @param {RetryHandlerOptions} options - The retry middleware options instance\n     * @returns A Promise that resolves to nothing\n     */\n    executeWithRetry(context, retryAttempts, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.nextMiddleware.execute(context);\n            if (retryAttempts < options.maxRetries && this.isRetry(context.response) && this.isBuffered(context.request, context.options) && options.shouldRetry(options.delay, retryAttempts, context.request, context.options, context.response)) {\n                ++retryAttempts;\n                setRequestHeader(context.request, context.options, RetryHandler.RETRY_ATTEMPT_HEADER, retryAttempts.toString());\n                const delay = this.getDelay(context.response, retryAttempts, options.delay);\n                yield this.sleep(delay);\n                return yield this.executeWithRetry(context, retryAttempts, options);\n            }\n            else {\n                return;\n            }\n        });\n    }\n    /**\n     * @public\n     * @async\n     * To execute the current middleware\n     * @param {Context} context - The context object of the request\n     * @returns A Promise that resolves to nothing\n     */\n    execute(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const retryAttempts = 0;\n            const options = this.getOptions(context);\n            TelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.RETRY_HANDLER_ENABLED);\n            return yield this.executeWithRetry(context, retryAttempts, options);\n        });\n    }\n    /**\n     * @public\n     * To set the next middleware in the chain\n     * @param {Middleware} next - The middleware instance\n     * @returns Nothing\n     */\n    setNext(next) {\n        this.nextMiddleware = next;\n    }\n}\n/**\n * @private\n * @static\n * A list of status codes that needs to be retried\n */\nRetryHandler.RETRY_STATUS_CODES = [\n    429,\n    503,\n    504, // Gateway timeout\n];\n/**\n * @private\n * @static\n * A member holding the name of retry attempt header\n */\nRetryHandler.RETRY_ATTEMPT_HEADER = \"Retry-Attempt\";\n/**\n * @private\n * @static\n * A member holding the name of retry after header\n */\nRetryHandler.RETRY_AFTER_HEADER = \"Retry-After\";\n//# sourceMappingURL=RetryHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @class\n * @implements MiddlewareOptions\n * A class representing RedirectHandlerOptions\n */\nexport class RedirectHandlerOptions {\n    /**\n     * @public\n     * @constructor\n     * To create an instance of RedirectHandlerOptions\n     * @param {number} [maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS] - The max redirects value\n     * @param {ShouldRedirect} [shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY] - The should redirect callback\n     * @returns An instance of RedirectHandlerOptions\n     */\n    constructor(maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS, shouldRedirect = RedirectHandlerOptions.defaultShouldRedirect) {\n        if (maxRedirects > RedirectHandlerOptions.MAX_MAX_REDIRECTS) {\n            const error = new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);\n            error.name = \"MaxLimitExceeded\";\n            throw error;\n        }\n        if (maxRedirects < 0) {\n            const error = new Error(`MaxRedirects should not be negative`);\n            error.name = \"MinExpectationNotMet\";\n            throw error;\n        }\n        this.maxRedirects = maxRedirects;\n        this.shouldRedirect = shouldRedirect;\n    }\n}\n/**\n * @private\n * @static\n * A member holding default max redirects value\n */\nRedirectHandlerOptions.DEFAULT_MAX_REDIRECTS = 5;\n/**\n * @private\n * @static\n * A member holding maximum max redirects value\n */\nRedirectHandlerOptions.MAX_MAX_REDIRECTS = 20;\n/**\n * @private\n * A member holding default shouldRedirect callback\n */\nRedirectHandlerOptions.defaultShouldRedirect = () => true;\n//# sourceMappingURL=RedirectHandlerOptions.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\nimport { RequestMethod } from \"../RequestMethod\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { cloneRequestWithNewUrl } from \"./MiddlewareUtil\";\nimport { RedirectHandlerOptions } from \"./options/RedirectHandlerOptions\";\nimport { FeatureUsageFlag, TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n/**\n * @class\n * Class\n * @implements Middleware\n * Class representing RedirectHandler\n */\nexport class RedirectHandler {\n    /**\n     * @public\n     * @constructor\n     * To create an instance of RedirectHandler\n     * @param {RedirectHandlerOptions} [options = new RedirectHandlerOptions()] - The redirect handler options instance\n     * @returns An instance of RedirectHandler\n     */\n    constructor(options = new RedirectHandlerOptions()) {\n        this.options = options;\n    }\n    /**\n     * @private\n     * To check whether the response has the redirect status code or not\n     * @param {Response} response - The response object\n     * @returns A boolean representing whether the response contains the redirect status code or not\n     */\n    isRedirect(response) {\n        return RedirectHandler.REDIRECT_STATUS_CODES.indexOf(response.status) !== -1;\n    }\n    /**\n     * @private\n     * To check whether the response has location header or not\n     * @param {Response} response - The response object\n     * @returns A boolean representing the whether the response has location header or not\n     */\n    hasLocationHeader(response) {\n        return response.headers.has(RedirectHandler.LOCATION_HEADER);\n    }\n    /**\n     * @private\n     * To get the redirect url from location header in response object\n     * @param {Response} response - The response object\n     * @returns A redirect url from location header\n     */\n    getLocationHeader(response) {\n        return response.headers.get(RedirectHandler.LOCATION_HEADER);\n    }\n    /**\n     * @private\n     * To check whether the given url is a relative url or not\n     * @param {string} url - The url string value\n     * @returns A boolean representing whether the given url is a relative url or not\n     */\n    isRelativeURL(url) {\n        return url.indexOf(\"://\") === -1;\n    }\n    /**\n     * @private\n     * To check whether the authorization header in the request should be dropped for consequent redirected requests\n     * @param {string} requestUrl - The request url value\n     * @param {string} redirectUrl - The redirect url value\n     * @returns A boolean representing whether the authorization header in the request should be dropped for consequent redirected requests\n     */\n    shouldDropAuthorizationHeader(requestUrl, redirectUrl) {\n        const schemeHostRegex = /^[A-Za-z].+?:\\/\\/.+?(?=\\/|$)/;\n        const requestMatches = schemeHostRegex.exec(requestUrl);\n        let requestAuthority;\n        let redirectAuthority;\n        if (requestMatches !== null) {\n            requestAuthority = requestMatches[0];\n        }\n        const redirectMatches = schemeHostRegex.exec(redirectUrl);\n        if (redirectMatches !== null) {\n            redirectAuthority = redirectMatches[0];\n        }\n        return typeof requestAuthority !== \"undefined\" && typeof redirectAuthority !== \"undefined\" && requestAuthority !== redirectAuthority;\n    }\n    /**\n     * @private\n     * @async\n     * To update a request url with the redirect url\n     * @param {string} redirectUrl - The redirect url value\n     * @param {Context} context - The context object value\n     * @returns Nothing\n     */\n    updateRequestUrl(redirectUrl, context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            context.request = typeof context.request === \"string\" ? redirectUrl : yield cloneRequestWithNewUrl(redirectUrl, context.request);\n        });\n    }\n    /**\n     * @private\n     * To get the options for execution of the middleware\n     * @param {Context} context - The context object\n     * @returns A options for middleware execution\n     */\n    getOptions(context) {\n        let options;\n        if (context.middlewareControl instanceof MiddlewareControl) {\n            options = context.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions);\n        }\n        if (typeof options === \"undefined\") {\n            options = Object.assign(new RedirectHandlerOptions(), this.options);\n        }\n        return options;\n    }\n    /**\n     * @private\n     * @async\n     * To execute the next middleware and to handle in case of redirect response returned by the server\n     * @param {Context} context - The context object\n     * @param {number} redirectCount - The redirect count value\n     * @param {RedirectHandlerOptions} options - The redirect handler options instance\n     * @returns A promise that resolves to nothing\n     */\n    executeWithRedirect(context, redirectCount, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.nextMiddleware.execute(context);\n            const response = context.response;\n            if (redirectCount < options.maxRedirects && this.isRedirect(response) && this.hasLocationHeader(response) && options.shouldRedirect(response)) {\n                ++redirectCount;\n                if (response.status === RedirectHandler.STATUS_CODE_SEE_OTHER) {\n                    context.options.method = RequestMethod.GET;\n                    delete context.options.body;\n                }\n                else {\n                    const redirectUrl = this.getLocationHeader(response);\n                    if (!this.isRelativeURL(redirectUrl) && this.shouldDropAuthorizationHeader(response.url, redirectUrl)) {\n                        delete context.options.headers[RedirectHandler.AUTHORIZATION_HEADER];\n                    }\n                    yield this.updateRequestUrl(redirectUrl, context);\n                }\n                yield this.executeWithRedirect(context, redirectCount, options);\n            }\n            else {\n                return;\n            }\n        });\n    }\n    /**\n     * @public\n     * @async\n     * To execute the current middleware\n     * @param {Context} context - The context object of the request\n     * @returns A Promise that resolves to nothing\n     */\n    execute(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const redirectCount = 0;\n            const options = this.getOptions(context);\n            context.options.redirect = RedirectHandler.MANUAL_REDIRECT;\n            TelemetryHandlerOptions.updateFeatureUsageFlag(context, FeatureUsageFlag.REDIRECT_HANDLER_ENABLED);\n            return yield this.executeWithRedirect(context, redirectCount, options);\n        });\n    }\n    /**\n     * @public\n     * To set the next middleware in the chain\n     * @param {Middleware} next - The middleware instance\n     * @returns Nothing\n     */\n    setNext(next) {\n        this.nextMiddleware = next;\n    }\n}\n/**\n * @private\n * @static\n * A member holding the array of redirect status codes\n */\nRedirectHandler.REDIRECT_STATUS_CODES = [\n    301,\n    302,\n    303,\n    307,\n    308, // Moved Permanently\n];\n/**\n * @private\n * @static\n * A member holding SeeOther status code\n */\nRedirectHandler.STATUS_CODE_SEE_OTHER = 303;\n/**\n * @private\n * @static\n * A member holding the name of the location header\n */\nRedirectHandler.LOCATION_HEADER = \"Location\";\n/**\n * @private\n * @static\n * A member representing the authorization header name\n */\nRedirectHandler.AUTHORIZATION_HEADER = \"Authorization\";\n/**\n * @private\n * @static\n * A member holding the manual redirect value\n */\nRedirectHandler.MANUAL_REDIRECT = \"manual\";\n//# sourceMappingURL=RedirectHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module TelemetryHandler\n */\nimport { isCustomHost, isGraphURL } from \"../GraphRequestUtil\";\nimport { PACKAGE_VERSION } from \"../Version\";\nimport { MiddlewareControl } from \"./MiddlewareControl\";\nimport { appendRequestHeader, generateUUID, getRequestHeader, setRequestHeader } from \"./MiddlewareUtil\";\nimport { TelemetryHandlerOptions } from \"./options/TelemetryHandlerOptions\";\n/**\n * @class\n * @implements Middleware\n * Class for TelemetryHandler\n */\nexport class TelemetryHandler {\n    /**\n     * @public\n     * @async\n     * To execute the current middleware\n     * @param {Context} context - The context object of the request\n     * @returns A Promise that resolves to nothing\n     */\n    execute(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = typeof context.request === \"string\" ? context.request : context.request.url;\n            if (isGraphURL(url) || (context.customHosts && isCustomHost(url, context.customHosts))) {\n                // Add telemetry only if the request url is a Graph URL.\n                // Errors are reported as in issue #265 if headers are present when redirecting to a non Graph URL\n                let clientRequestId = getRequestHeader(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER);\n                if (!clientRequestId) {\n                    clientRequestId = generateUUID();\n                    setRequestHeader(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER, clientRequestId);\n                }\n                let sdkVersionValue = `${TelemetryHandler.PRODUCT_NAME}/${PACKAGE_VERSION}`;\n                let options;\n                if (context.middlewareControl instanceof MiddlewareControl) {\n                    options = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions);\n                }\n                if (options) {\n                    const featureUsage = options.getFeatureUsage();\n                    sdkVersionValue += ` (${TelemetryHandler.FEATURE_USAGE_STRING}=${featureUsage})`;\n                }\n                appendRequestHeader(context.request, context.options, TelemetryHandler.SDK_VERSION_HEADER, sdkVersionValue);\n            }\n            else {\n                // Remove telemetry headers if present during redirection.\n                delete context.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER];\n                delete context.options.headers[TelemetryHandler.SDK_VERSION_HEADER];\n            }\n            return yield this.nextMiddleware.execute(context);\n        });\n    }\n    /**\n     * @public\n     * To set the next middleware in the chain\n     * @param {Middleware} next - The middleware instance\n     * @returns Nothing\n     */\n    setNext(next) {\n        this.nextMiddleware = next;\n    }\n}\n/**\n * @private\n * @static\n * A member holding the name of the client request id header\n */\nTelemetryHandler.CLIENT_REQUEST_ID_HEADER = \"client-request-id\";\n/**\n * @private\n * @static\n * A member holding the name of the sdk version header\n */\nTelemetryHandler.SDK_VERSION_HEADER = \"SdkVersion\";\n/**\n * @private\n * @static\n * A member holding the language prefix for the sdk version header value\n */\nTelemetryHandler.PRODUCT_NAME = \"graph-js\";\n/**\n * @private\n * @static\n * A member holding the key for the feature usage metrics\n */\nTelemetryHandler.FEATURE_USAGE_STRING = \"featureUsage\";\n//# sourceMappingURL=TelemetryHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\nimport { ResponseType } from \"./ResponseType\";\n/**\n * @enum\n * Enum for document types\n * @property {string} TEXT_HTML - The text/html content type\n * @property {string} TEXT_XML - The text/xml content type\n * @property {string} APPLICATION_XML - The application/xml content type\n * @property {string} APPLICATION_XHTML - The application/xhml+xml content type\n */\nexport var DocumentType;\n(function (DocumentType) {\n    DocumentType[\"TEXT_HTML\"] = \"text/html\";\n    DocumentType[\"TEXT_XML\"] = \"text/xml\";\n    DocumentType[\"APPLICATION_XML\"] = \"application/xml\";\n    DocumentType[\"APPLICATION_XHTML\"] = \"application/xhtml+xml\";\n})(DocumentType || (DocumentType = {}));\n/**\n * @enum\n * Enum for Content types\n * @property {string} TEXT_PLAIN - The text/plain content type\n * @property {string} APPLICATION_JSON - The application/json content type\n */\nvar ContentType;\n(function (ContentType) {\n    ContentType[\"TEXT_PLAIN\"] = \"text/plain\";\n    ContentType[\"APPLICATION_JSON\"] = \"application/json\";\n})(ContentType || (ContentType = {}));\n/**\n * @enum\n * Enum for Content type regex\n * @property {string} DOCUMENT - The regex to match document content types\n * @property {string} IMAGE - The regex to match image content types\n */\nvar ContentTypeRegexStr;\n(function (ContentTypeRegexStr) {\n    ContentTypeRegexStr[\"DOCUMENT\"] = \"^(text\\\\/(html|xml))|(application\\\\/(xml|xhtml\\\\+xml))$\";\n    ContentTypeRegexStr[\"IMAGE\"] = \"^image\\\\/.+\";\n})(ContentTypeRegexStr || (ContentTypeRegexStr = {}));\n/**\n * @class\n * Class for GraphResponseHandler\n */\nexport class GraphResponseHandler {\n    /**\n     * @private\n     * @static\n     * To parse Document response\n     * @param {Response} rawResponse - The response object\n     * @param {DocumentType} type - The type to which the document needs to be parsed\n     * @returns A promise that resolves to a document content\n     */\n    static parseDocumentResponse(rawResponse, type) {\n        if (typeof DOMParser !== \"undefined\") {\n            return new Promise((resolve, reject) => {\n                rawResponse.text().then((xmlString) => {\n                    try {\n                        const parser = new DOMParser();\n                        const xmlDoc = parser.parseFromString(xmlString, type);\n                        resolve(xmlDoc);\n                    }\n                    catch (error) {\n                        reject(error);\n                    }\n                });\n            });\n        }\n        else {\n            return Promise.resolve(rawResponse.body);\n        }\n    }\n    /**\n     * @private\n     * @static\n     * @async\n     * To convert the native Response to response content\n     * @param {Response} rawResponse - The response object\n     * @param {ResponseType} [responseType] - The response type value\n     * @returns A promise that resolves to the converted response content\n     */\n    static convertResponse(rawResponse, responseType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (rawResponse.status === 204) {\n                // NO CONTENT\n                return Promise.resolve();\n            }\n            let responseValue;\n            const contentType = rawResponse.headers.get(\"Content-type\");\n            switch (responseType) {\n                case ResponseType.ARRAYBUFFER:\n                    responseValue = yield rawResponse.arrayBuffer();\n                    break;\n                case ResponseType.BLOB:\n                    responseValue = yield rawResponse.blob();\n                    break;\n                case ResponseType.DOCUMENT:\n                    responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, DocumentType.TEXT_XML);\n                    break;\n                case ResponseType.JSON:\n                    responseValue = yield rawResponse.json();\n                    break;\n                case ResponseType.STREAM:\n                    responseValue = yield Promise.resolve(rawResponse.body);\n                    break;\n                case ResponseType.TEXT:\n                    responseValue = yield rawResponse.text();\n                    break;\n                default:\n                    if (contentType !== null) {\n                        const mimeType = contentType.split(\";\")[0];\n                        if (new RegExp(ContentTypeRegexStr.DOCUMENT).test(mimeType)) {\n                            responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, mimeType);\n                        }\n                        else if (new RegExp(ContentTypeRegexStr.IMAGE).test(mimeType)) {\n                            responseValue = rawResponse.blob();\n                        }\n                        else if (mimeType === ContentType.TEXT_PLAIN) {\n                            responseValue = yield rawResponse.text();\n                        }\n                        else if (mimeType === ContentType.APPLICATION_JSON) {\n                            responseValue = yield rawResponse.json();\n                        }\n                        else {\n                            responseValue = Promise.resolve(rawResponse.body);\n                        }\n                    }\n                    else {\n                        /**\n                         * RFC specification {@link https://tools.ietf.org/html/rfc7231#section-3.1.1.5} says:\n                         *  A sender that generates a message containing a payload body SHOULD\n                         *  generate a Content-Type header field in that message unless the\n                         *  intended media type of the enclosed representation is unknown to the\n                         *  sender.  If a Content-Type header field is not present, the recipient\n                         *  MAY either assume a media type of \"application/octet-stream\"\n                         *  ([RFC2046], Section 4.5.1) or examine the data to determine its type.\n                         *\n                         *  So assuming it as a stream type so returning the body.\n                         */\n                        responseValue = Promise.resolve(rawResponse.body);\n                    }\n                    break;\n            }\n            return responseValue;\n        });\n    }\n    /**\n     * @public\n     * @static\n     * @async\n     * To get the parsed response\n     * @param {Response} rawResponse - The response object\n     * @param {ResponseType} [responseType] - The response type value\n     * @param {GraphRequestCallback} [callback] - The graph request callback function\n     * @returns The parsed response\n     */\n    static getResponse(rawResponse, responseType, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (responseType === ResponseType.RAW) {\n                return Promise.resolve(rawResponse);\n            }\n            else {\n                const response = yield GraphResponseHandler.convertResponse(rawResponse, responseType);\n                if (rawResponse.ok) {\n                    // Status Code 2XX\n                    if (typeof callback === \"function\") {\n                        callback(null, response);\n                    }\n                    else {\n                        return response;\n                    }\n                }\n                else {\n                    // NOT OK Response\n                    throw response;\n                }\n            }\n        });\n    }\n}\n//# sourceMappingURL=GraphResponseHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module Range\n */\n/**\n * @class\n * Class representing Range\n */\nexport class Range {\n    /**\n     * @public\n     * @constructor\n     * Creates a range for given min and max values\n     * @param {number} [minVal = -1] - The minimum value.\n     * @param {number} [maxVal = -1] - The maximum value.\n     * @returns An instance of a Range\n     */\n    constructor(minVal = -1, maxVal = -1) {\n        this.minValue = minVal;\n        this.maxValue = maxVal;\n    }\n}\n//# sourceMappingURL=Range.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * Class representing a successful file upload result\n */\nexport class UploadResult {\n    /**\n     * @public\n     * Get of the location value.\n     * Location value is looked up in the response header\n     */\n    get location() {\n        return this._location;\n    }\n    /**\n     * @public\n     * Set the location value\n     * Location value is looked up in the response header\n     */\n    set location(location) {\n        this._location = location;\n    }\n    /**\n     * @public\n     * Get The response body from the completed upload response\n     */\n    get responseBody() {\n        return this._responseBody;\n    }\n    /**\n     * @public\n     * Set the response body from the completed upload response\n     */\n    set responseBody(responseBody) {\n        this._responseBody = responseBody;\n    }\n    /**\n     * @public\n     * @param {responseBody} responsebody - The response body from the completed upload response\n     * @param {location} location - The location value from the headers from the completed upload response\n     */\n    constructor(responseBody, location) {\n        // Response body or the location parameter can be undefined.\n        this._location = location;\n        this._responseBody = responseBody;\n    }\n    /**\n     * @public\n     * @param {responseBody} responseBody - The response body from the completed upload response\n     * @param {responseHeaders} responseHeaders - The headers from the completed upload response\n     */\n    static CreateUploadResult(responseBody, responseHeaders) {\n        return new UploadResult(responseBody, responseHeaders.get(\"location\"));\n    }\n}\n//# sourceMappingURL=UploadResult.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module LargeFileUploadTask\n */\nimport { GraphClientError } from \"../GraphClientError\";\nimport { GraphResponseHandler } from \"../GraphResponseHandler\";\nimport { ResponseType } from \"../ResponseType\";\nimport { Range } from \"./FileUploadTask/Range\";\nimport { UploadResult } from \"./FileUploadTask/UploadResult\";\n/**\n * @class\n * Class representing LargeFileUploadTask\n */\nexport class LargeFileUploadTask {\n    /**\n     * @public\n     * @static\n     * @async\n     * Makes request to the server to create an upload session\n     * @param {Client} client - The GraphClient instance\n     * @param {string} requestUrl - The URL to create the upload session\n     * @param {any} payload - The payload that needs to be sent\n     * @param {KeyValuePairObjectStringNumber} headers - The headers that needs to be sent\n     * @returns The promise that resolves to LargeFileUploadSession\n     */\n    static createUploadSession(client, requestUrl, payload, headers = {}) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const session = yield client\n                .api(requestUrl)\n                .headers(headers)\n                .post(payload);\n            const largeFileUploadSession = {\n                url: session.uploadUrl,\n                expiry: new Date(session.expirationDateTime),\n                isCancelled: false,\n            };\n            return largeFileUploadSession;\n        });\n    }\n    /**\n     * @public\n     * @constructor\n     * Constructs a LargeFileUploadTask\n     * @param {Client} client - The GraphClient instance\n     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded\n     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done\n     * @param {LargeFileUploadTaskOptions} options - The upload task options\n     * @returns An instance of LargeFileUploadTask\n     */\n    constructor(client, file, uploadSession, options = {}) {\n        /**\n         * @private\n         * Default value for the rangeSize\n         */\n        this.DEFAULT_FILE_SIZE = 5 * 1024 * 1024;\n        this.client = client;\n        if (!file.sliceFile) {\n            throw new GraphClientError(\"Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface\");\n        }\n        else {\n            this.file = file;\n        }\n        this.file = file;\n        if (!options.rangeSize) {\n            options.rangeSize = this.DEFAULT_FILE_SIZE;\n        }\n        this.options = options;\n        this.uploadSession = uploadSession;\n        this.nextRange = new Range(0, this.options.rangeSize - 1);\n    }\n    /**\n     * @private\n     * Parses given range string to the Range instance\n     * @param {string[]} ranges - The ranges value\n     * @returns The range instance\n     */\n    parseRange(ranges) {\n        const rangeStr = ranges[0];\n        if (typeof rangeStr === \"undefined\" || rangeStr === \"\") {\n            return new Range();\n        }\n        const firstRange = rangeStr.split(\"-\");\n        const minVal = parseInt(firstRange[0], 10);\n        let maxVal = parseInt(firstRange[1], 10);\n        if (Number.isNaN(maxVal)) {\n            maxVal = this.file.size - 1;\n        }\n        return new Range(minVal, maxVal);\n    }\n    /**\n     * @private\n     * Updates the expiration date and the next range\n     * @param {UploadStatusResponse} response - The response of the upload status\n     * @returns Nothing\n     */\n    updateTaskStatus(response) {\n        this.uploadSession.expiry = new Date(response.expirationDateTime);\n        this.nextRange = this.parseRange(response.nextExpectedRanges);\n    }\n    /**\n     * @public\n     * Gets next range that needs to be uploaded\n     * @returns The range instance\n     */\n    getNextRange() {\n        if (this.nextRange.minValue === -1) {\n            return this.nextRange;\n        }\n        const minVal = this.nextRange.minValue;\n        let maxValue = minVal + this.options.rangeSize - 1;\n        if (maxValue >= this.file.size) {\n            maxValue = this.file.size - 1;\n        }\n        return new Range(minVal, maxValue);\n    }\n    /**\n     * @deprecated This function has been moved into FileObject interface.\n     * @public\n     * Slices the file content to the given range\n     * @param {Range} range - The range value\n     * @returns The sliced ArrayBuffer or Blob\n     */\n    sliceFile(range) {\n        console.warn(\"The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface.\");\n        if (this.file.content instanceof ArrayBuffer || this.file.content instanceof Blob || this.file.content instanceof Uint8Array) {\n            return this.file.content.slice(range.minValue, range.maxValue + 1);\n        }\n        throw new GraphClientError(\"The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.\");\n    }\n    /**\n     * @public\n     * @async\n     * Uploads file to the server in a sequential order by slicing the file\n     * @returns The promise resolves to uploaded response\n     */\n    upload() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const uploadEventHandlers = this.options && this.options.uploadEventHandlers;\n            while (!this.uploadSession.isCancelled) {\n                const nextRange = this.getNextRange();\n                if (nextRange.maxValue === -1) {\n                    const err = new Error(\"Task with which you are trying to upload is already completed, Please check for your uploaded file\");\n                    err.name = \"Invalid Session\";\n                    throw err;\n                }\n                const fileSlice = yield this.file.sliceFile(nextRange);\n                const rawResponse = yield this.uploadSliceGetRawResponse(fileSlice, nextRange, this.file.size);\n                if (!rawResponse) {\n                    throw new GraphClientError(\"Something went wrong! Large file upload slice response is null.\");\n                }\n                const responseBody = yield GraphResponseHandler.getResponse(rawResponse);\n                /**\n                 * (rawResponse.status === 201) -> This condition is applicable for OneDrive, PrintDocument and Outlook APIs.\n                 * (rawResponse.status === 200 && responseBody.id) -> This additional condition is applicable only for OneDrive API.\n                 */\n                if (rawResponse.status === 201 || (rawResponse.status === 200 && responseBody.id)) {\n                    this.reportProgress(uploadEventHandlers, nextRange);\n                    return UploadResult.CreateUploadResult(responseBody, rawResponse.headers);\n                }\n                /* Handling the API issue where the case of Outlook upload response property -'nextExpectedRanges'  is not uniform.\n                 * https://github.com/microsoftgraph/msgraph-sdk-serviceissues/issues/39\n                 */\n                const res = {\n                    expirationDateTime: responseBody.expirationDateTime || responseBody.ExpirationDateTime,\n                    nextExpectedRanges: responseBody.NextExpectedRanges || responseBody.nextExpectedRanges,\n                };\n                this.updateTaskStatus(res);\n                this.reportProgress(uploadEventHandlers, nextRange);\n            }\n        });\n    }\n    reportProgress(uploadEventHandlers, nextRange) {\n        if (uploadEventHandlers && uploadEventHandlers.progress) {\n            uploadEventHandlers.progress(nextRange, uploadEventHandlers.extraCallbackParam);\n        }\n    }\n    /**\n     * @public\n     * @async\n     * Uploads given slice to the server\n     * @param {ArrayBuffer | Blob | File} fileSlice - The file slice\n     * @param {Range} range - The range value\n     * @param {number} totalSize - The total size of a complete file\n     * @returns The response body of the upload slice result\n     */\n    uploadSlice(fileSlice, range, totalSize) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.client\n                .api(this.uploadSession.url)\n                .headers({\n                \"Content-Length\": `${range.maxValue - range.minValue + 1}`,\n                \"Content-Range\": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,\n                \"Content-Type\": \"application/octet-stream\",\n            })\n                .put(fileSlice);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Uploads given slice to the server\n     * @param {unknown} fileSlice - The file slice\n     * @param {Range} range - The range value\n     * @param {number} totalSize - The total size of a complete file\n     * @returns The raw response of the upload slice result\n     */\n    uploadSliceGetRawResponse(fileSlice, range, totalSize) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.client\n                .api(this.uploadSession.url)\n                .headers({\n                \"Content-Length\": `${range.maxValue - range.minValue + 1}`,\n                \"Content-Range\": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,\n                \"Content-Type\": \"application/octet-stream\",\n            })\n                .responseType(ResponseType.RAW)\n                .put(fileSlice);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Deletes upload session in the server\n     * @returns The promise resolves to cancelled response\n     */\n    cancel() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cancelResponse = yield this.client\n                .api(this.uploadSession.url)\n                .responseType(ResponseType.RAW)\n                .delete();\n            if (cancelResponse.status === 204) {\n                this.uploadSession.isCancelled = true;\n            }\n            return cancelResponse;\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Gets status for the upload session\n     * @returns The promise resolves to the status enquiry response\n     */\n    getStatus() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const response = yield this.client.api(this.uploadSession.url).get();\n            this.updateTaskStatus(response);\n            return response;\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Resumes upload session and continue uploading the file from the last sent range\n     * @returns The promise resolves to the uploaded response\n     */\n    resume() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.getStatus();\n            return yield this.upload();\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Get the upload session information\n     * @returns The large file upload session\n     */\n    getUploadSession() {\n        return this.uploadSession;\n    }\n}\n//# sourceMappingURL=LargeFileUploadTask.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { GraphClientError } from \"../../../GraphClientError\";\n/**\n * @class\n * Class used for creating LargeFileUploadTask fileobject.\n * This class accepts files of type ArrayBuffer, Blob, Uint8Array.\n */\nexport class FileUpload {\n    /**\n     * @public\n     * @constructor\n     * @param {ArrayBuffer | Blob | Uint8Array} content - The file to be uploaded\n     * @param {string} name - The name of the file to be uploaded\n     * @param {number} size - The total size of the file to be uploaded\n     * @returns An instance of the FileUpload class\n     */\n    constructor(content, name, size) {\n        this.content = content;\n        this.name = name;\n        this.size = size;\n        if (!content || !name || !size) {\n            throw new GraphClientError(\"Please provide the upload content, name of the file and size of the file\");\n        }\n    }\n    /**\n     * @public\n     * Slices the file content to the given range\n     * @param {Range} range - The range value\n     * @returns The sliced file part\n     */\n    sliceFile(range) {\n        return this.content.slice(range.minValue, range.maxValue + 1);\n    }\n}\n//# sourceMappingURL=FileUpload.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module OneDriveLargeFileUploadTask\n */\nimport { GraphClientError } from \"../GraphClientError\";\nimport { FileUpload } from \"./FileUploadTask/FileObjectClasses/FileUpload\";\nimport { LargeFileUploadTask } from \"./LargeFileUploadTask\";\nimport { getValidRangeSize } from \"./OneDriveLargeFileUploadTaskUtil\";\n/**\n * @class\n * Class representing OneDriveLargeFileUploadTask\n */\nexport class OneDriveLargeFileUploadTask extends LargeFileUploadTask {\n    /**\n     * @private\n     * @static\n     * Constructs the create session url for Onedrive\n     * @param {string} fileName - The name of the file\n     * @param {path} [path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH] - The path for the upload\n     * @returns The constructed create session url\n     */\n    static constructCreateSessionUrl(fileName, path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH) {\n        fileName = fileName.trim();\n        path = path.trim();\n        if (path === \"\") {\n            path = \"/\";\n        }\n        if (path[0] !== \"/\") {\n            path = `/${path}`;\n        }\n        if (path[path.length - 1] !== \"/\") {\n            path = `${path}/`;\n        }\n        // we choose to encode each component of the file path separately because when encoding full URI\n        // with encodeURI, special characters like # or % in the file name doesn't get encoded as desired\n        return `/me/drive/root:${path\n            .split(\"/\")\n            .map((p) => encodeURIComponent(p))\n            .join(\"/\")}${encodeURIComponent(fileName)}:/createUploadSession`;\n    }\n    /**\n     * @private\n     * @static\n     * Get file information\n     * @param {Blob | Uint8Array | File} file - The file entity\n     * @param {string} fileName - The file name\n     * @returns {FileInfo} The file information\n     */\n    static getFileInfo(file, fileName) {\n        let content;\n        let size;\n        if (typeof Blob !== \"undefined\" && file instanceof Blob) {\n            content = new File([file], fileName);\n            size = content.size;\n        }\n        else if (typeof File !== \"undefined\" && file instanceof File) {\n            content = file;\n            size = content.size;\n        }\n        else if (typeof Uint8Array !== \"undefined\" && file instanceof Uint8Array) {\n            const b = file;\n            size = b.byteLength;\n            content = b.buffer.slice(b.byteOffset, b.byteOffset + b.byteLength);\n        }\n        return {\n            content,\n            size,\n        };\n    }\n    /**\n     * @public\n     * @static\n     * @async\n     * Creates a OneDriveLargeFileUploadTask\n     * @param {Client} client - The GraphClient instance\n     * @param {Blob | Uint8Array | File} file - File represented as Blob, Uint8Array or File\n     * @param {OneDriveLargeFileUploadOptions} options - The options for upload task\n     * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance\n     */\n    static create(client, file, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!client || !file || !options) {\n                throw new GraphClientError(\"Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value\");\n            }\n            const fileName = options.fileName;\n            const fileInfo = OneDriveLargeFileUploadTask.getFileInfo(file, fileName);\n            const fileObj = new FileUpload(fileInfo.content, fileName, fileInfo.size);\n            return this.createTaskWithFileObject(client, fileObj, options);\n        });\n    }\n    /**\n     * @public\n     * @static\n     * @async\n     * Creates a OneDriveLargeFileUploadTask\n     * @param {Client} client - The GraphClient instance\n     * @param {FileObject} fileObject - FileObject instance\n     * @param {OneDriveLargeFileUploadOptions} options - The options for upload task\n     * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance\n     */\n    static createTaskWithFileObject(client, fileObject, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!client || !fileObject || !options) {\n                throw new GraphClientError(\"Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value\");\n            }\n            const requestUrl = options.uploadSessionURL ? options.uploadSessionURL : OneDriveLargeFileUploadTask.constructCreateSessionUrl(options.fileName, options.path);\n            const uploadSessionPayload = {\n                fileName: options.fileName,\n                fileDescription: options.fileDescription,\n                conflictBehavior: options.conflictBehavior,\n            };\n            const session = yield OneDriveLargeFileUploadTask.createUploadSession(client, requestUrl, uploadSessionPayload);\n            const rangeSize = getValidRangeSize(options.rangeSize);\n            return new OneDriveLargeFileUploadTask(client, fileObject, session, {\n                rangeSize,\n                uploadEventHandlers: options.uploadEventHandlers,\n            });\n        });\n    }\n    /**\n     * @public\n     * @static\n     * @async\n     * Makes request to the server to create an upload session\n     * @param {Client} client - The GraphClient instance\n     * @param {string} requestUrl - The URL to create the upload session\n     * @param {string} payloadOptions - The payload option. Default conflictBehavior is 'rename'\n     * @returns The promise that resolves to LargeFileUploadSession\n     */\n    static createUploadSession(client, requestUrl, payloadOptions) {\n        const _super = Object.create(null, {\n            createUploadSession: { get: () => super.createUploadSession }\n        });\n        return __awaiter(this, void 0, void 0, function* () {\n            const payload = {\n                item: {\n                    \"@microsoft.graph.conflictBehavior\": (payloadOptions === null || payloadOptions === void 0 ? void 0 : payloadOptions.conflictBehavior) || \"rename\",\n                    name: payloadOptions === null || payloadOptions === void 0 ? void 0 : payloadOptions.fileName,\n                    description: payloadOptions === null || payloadOptions === void 0 ? void 0 : payloadOptions.fileDescription,\n                },\n            };\n            return _super.createUploadSession.call(this, client, requestUrl, payload);\n        });\n    }\n    /**\n     * @public\n     * @constructor\n     * Constructs a OneDriveLargeFileUploadTask\n     * @param {Client} client - The GraphClient instance\n     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded\n     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done\n     * @param {LargeFileUploadTaskOptions} options - The upload task options\n     * @returns An instance of OneDriveLargeFileUploadTask\n     */\n    constructor(client, file, uploadSession, options) {\n        super(client, file, uploadSession, options);\n    }\n    /**\n     * @public\n     * Commits upload session to end uploading\n     * @param {string} requestUrl - The URL to commit the upload session\n     * @param {string} conflictBehavior - Conflict behaviour option. Default is 'rename'\n     * @returns The promise resolves to committed response\n     */\n    commit(requestUrl, conflictBehavior = \"rename\") {\n        return __awaiter(this, void 0, void 0, function* () {\n            const payload = {\n                name: this.file.name,\n                \"@microsoft.graph.conflictBehavior\": conflictBehavior,\n                \"@microsoft.graph.sourceUrl\": this.uploadSession.url,\n            };\n            return yield this.client.api(requestUrl).put(payload);\n        });\n    }\n}\n/**\n * @private\n * @static\n * Default path for the file being uploaded\n */\nOneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH = \"/\";\n//# sourceMappingURL=OneDriveLargeFileUploadTask.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module OneDriveLargeFileUploadTaskUtil\n */\n/**\n * @constant\n * Default value for the rangeSize\n * Recommended size is between 5 - 10 MB {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#best-practices}\n */\nconst DEFAULT_FILE_SIZE = 5 * 1024 * 1024;\n/**\n * @constant\n * Rounds off the given value to a multiple of 320 KB\n * @param {number} value - The value\n * @returns The rounded off value\n */\nconst roundTo320KB = (value) => {\n    if (value > 320 * 1024) {\n        value = Math.floor(value / (320 * 1024)) * 320 * 1024;\n    }\n    return value;\n};\n/**\n * @constant\n * Get the valid rangeSize for a file slicing (validity is based on the constrains mentioned in here\n * {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#upload-bytes-to-the-upload-session})\n *\n * @param {number} [rangeSize = DEFAULT_FILE_SIZE] - The rangeSize value.\n * @returns The valid rangeSize\n */\nexport const getValidRangeSize = (rangeSize = DEFAULT_FILE_SIZE) => {\n    const sixtyMB = 60 * 1024 * 1024;\n    if (rangeSize > sixtyMB) {\n        rangeSize = sixtyMB;\n    }\n    return roundTo320KB(rangeSize);\n};\n//# sourceMappingURL=OneDriveLargeFileUploadTaskUtil.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module CustomAuthenticationProvider\n */\nimport { GraphClientError } from \"./GraphClientError\";\n/**\n * @class\n * Class representing CustomAuthenticationProvider\n * @extends AuthenticationProvider\n */\nexport class CustomAuthenticationProvider {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of CustomAuthenticationProvider\n     * @param {AuthProviderCallback} provider - An authProvider function\n     * @returns An instance of CustomAuthenticationProvider\n     */\n    constructor(provider) {\n        this.provider = provider;\n    }\n    /**\n     * @public\n     * @async\n     * To get the access token\n     * @returns The promise that resolves to an access token\n     */\n    getAccessToken() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                this.provider((error, accessToken) => __awaiter(this, void 0, void 0, function* () {\n                    if (accessToken) {\n                        resolve(accessToken);\n                    }\n                    else {\n                        if (!error) {\n                            const invalidTokenMessage = \"Access token is undefined or empty.\\\n\t\t\t\t\t\tPlease provide a valid token.\\\n\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md\";\n                            error = new GraphClientError(invalidTokenMessage);\n                        }\n                        const err = yield GraphClientError.setGraphClientError(error);\n                        reject(err);\n                    }\n                }));\n            });\n        });\n    }\n}\n//# sourceMappingURL=CustomAuthenticationProvider.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module GraphError\n */\n/**\n * @class\n * Class for GraphError\n * @NOTE: This is NOT what is returned from the Graph\n * GraphError is created from parsing JSON errors returned from the graph\n * Some fields are renamed ie, \"request-id\" => requestId so you can use dot notation\n */\nexport class GraphError extends Error {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of GraphError\n     * @param {number} [statusCode = -1] - The status code of the error\n     * @param {string} [message] - The message of the error\n     * @param {Error} [baseError] - The base error\n     * @returns An instance of GraphError\n     */\n    constructor(statusCode = -1, message, baseError) {\n        super(message || (baseError && baseError.message));\n        // https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n        Object.setPrototypeOf(this, GraphError.prototype);\n        this.statusCode = statusCode;\n        this.code = null;\n        this.requestId = null;\n        this.date = new Date();\n        this.body = null;\n        this.stack = baseError ? baseError.stack : this.stack;\n    }\n}\n//# sourceMappingURL=GraphError.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module GraphErrorHandler\n */\nimport { GraphError } from \"./GraphError\";\n/**\n * @class\n * Class for GraphErrorHandler\n */\nexport class GraphErrorHandler {\n    /**\n     * @private\n     * @static\n     * Populates the GraphError instance with Error instance values\n     * @param {Error} error - The error returned by graph service or some native error\n     * @param {number} [statusCode] - The status code of the response\n     * @returns The GraphError instance\n     */\n    static constructError(error, statusCode, rawResponse) {\n        const gError = new GraphError(statusCode, \"\", error);\n        if (error.name !== undefined) {\n            gError.code = error.name;\n        }\n        gError.body = error.toString();\n        gError.date = new Date();\n        gError.headers = rawResponse === null || rawResponse === void 0 ? void 0 : rawResponse.headers;\n        return gError;\n    }\n    /**\n     * @private\n     * @static\n     * @async\n     * Populates the GraphError instance from the Error returned by graph service\n     * @param {GraphAPIErrorResponse} graphError - The error possibly returned by graph service or some native error\n     * @param {number} statusCode - The status code of the response\n     * @returns A promise that resolves to GraphError instance\n     *\n     * Example error for https://graph.microsoft.com/v1.0/me/events?$top=3&$search=foo\n     * {\n     *      \"error\": {\n     *          \"code\": \"SearchEvents\",\n     *          \"message\": \"The parameter $search is not currently supported on the Events resource.\",\n     *          \"innerError\": {\n     *              \"request-id\": \"b31c83fd-944c-4663-aa50-5d9ceb367e19\",\n     *              \"date\": \"2016-11-17T18:37:45\"\n     *          }\n     *      }\n     *  }\n     */\n    static constructErrorFromResponse(graphError, statusCode, rawResponse) {\n        const error = graphError.error;\n        const gError = new GraphError(statusCode, error.message);\n        gError.code = error.code;\n        if (error.innerError !== undefined) {\n            gError.requestId = error.innerError[\"request-id\"];\n            gError.date = new Date(error.innerError.date);\n        }\n        gError.body = JSON.stringify(error);\n        gError.headers = rawResponse === null || rawResponse === void 0 ? void 0 : rawResponse.headers;\n        return gError;\n    }\n    /**\n     * @public\n     * @static\n     * @async\n     * To get the GraphError object\n     * Reference - https://docs.microsoft.com/en-us/graph/errors\n     * @param {any} [error = null] - The error returned by graph service or some native error\n     * @param {number} [statusCode = -1] - The status code of the response\n     * @param {GraphRequestCallback} [callback] - The graph request callback function\n     * @returns A promise that resolves to GraphError instance\n     */\n    static getError(error = null, statusCode = -1, callback, rawResponse) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let gError;\n            if (error && error.error) {\n                gError = GraphErrorHandler.constructErrorFromResponse(error, statusCode, rawResponse);\n            }\n            else if (error instanceof Error) {\n                gError = GraphErrorHandler.constructError(error, statusCode, rawResponse);\n            }\n            else {\n                gError = new GraphError(statusCode);\n                gError.body = error; // if a custom error is passed which is not instance of Error object or a graph API response\n            }\n            if (typeof callback === \"function\") {\n                callback(gError, null);\n            }\n            else {\n                return gError;\n            }\n        });\n    }\n}\n//# sourceMappingURL=GraphErrorHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @module GraphRequest\n */\nimport { GraphClientError } from \"./GraphClientError\";\nimport { GraphErrorHandler } from \"./GraphErrorHandler\";\nimport { oDataQueryNames, serializeContent, urlJoin } from \"./GraphRequestUtil\";\nimport { GraphResponseHandler } from \"./GraphResponseHandler\";\nimport { MiddlewareControl } from \"./middleware/MiddlewareControl\";\nimport { RequestMethod } from \"./RequestMethod\";\nimport { ResponseType } from \"./ResponseType\";\n/**\n * @class\n * A Class representing GraphRequest\n */\nexport class GraphRequest {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of GraphRequest\n     * @param {HTTPClient} httpClient - The HTTPClient instance\n     * @param {ClientOptions} config - The options for making request\n     * @param {string} path - A path string\n     */\n    constructor(httpClient, config, path) {\n        /**\n         * @private\n         * Parses the path string and creates URLComponents out of it\n         * @param {string} path - The request path string\n         * @returns Nothing\n         */\n        this.parsePath = (path) => {\n            // Strips out the base of the url if they passed in\n            if (path.indexOf(\"https://\") !== -1) {\n                path = path.replace(\"https://\", \"\");\n                // Find where the host ends\n                const endOfHostStrPos = path.indexOf(\"/\");\n                if (endOfHostStrPos !== -1) {\n                    // Parse out the host\n                    this.urlComponents.host = \"https://\" + path.substring(0, endOfHostStrPos);\n                    // Strip the host from path\n                    path = path.substring(endOfHostStrPos + 1, path.length);\n                }\n                // Remove the following version\n                const endOfVersionStrPos = path.indexOf(\"/\");\n                if (endOfVersionStrPos !== -1) {\n                    // Parse out the version\n                    this.urlComponents.version = path.substring(0, endOfVersionStrPos);\n                    // Strip version from path\n                    path = path.substring(endOfVersionStrPos + 1, path.length);\n                }\n            }\n            // Strip out any leading \"/\"\n            if (path.charAt(0) === \"/\") {\n                path = path.substr(1);\n            }\n            const queryStrPos = path.indexOf(\"?\");\n            if (queryStrPos === -1) {\n                // No query string\n                this.urlComponents.path = path;\n            }\n            else {\n                this.urlComponents.path = path.substr(0, queryStrPos);\n                // Capture query string into oDataQueryParams and otherURLQueryParams\n                const queryParams = path.substring(queryStrPos + 1, path.length).split(\"&\");\n                for (const queryParam of queryParams) {\n                    this.parseQueryParameter(queryParam);\n                }\n            }\n        };\n        this.httpClient = httpClient;\n        this.config = config;\n        this.urlComponents = {\n            host: this.config.baseUrl,\n            version: this.config.defaultVersion,\n            oDataQueryParams: {},\n            otherURLQueryParams: {},\n            otherURLQueryOptions: [],\n        };\n        this._headers = {};\n        this._options = {};\n        this._middlewareOptions = [];\n        this.parsePath(path);\n    }\n    /**\n     * @private\n     * Adds the query parameter as comma separated values\n     * @param {string} propertyName - The name of a property\n     * @param {string|string[]} propertyValue - The vale of a property\n     * @param {IArguments} additionalProperties - The additional properties\n     * @returns Nothing\n     */\n    addCsvQueryParameter(propertyName, propertyValue, additionalProperties) {\n        // If there are already $propertyName value there, append a \",\"\n        this.urlComponents.oDataQueryParams[propertyName] = this.urlComponents.oDataQueryParams[propertyName] ? this.urlComponents.oDataQueryParams[propertyName] + \",\" : \"\";\n        let allValues = [];\n        if (additionalProperties.length > 1 && typeof propertyValue === \"string\") {\n            allValues = Array.prototype.slice.call(additionalProperties);\n        }\n        else if (typeof propertyValue === \"string\") {\n            allValues.push(propertyValue);\n        }\n        else {\n            allValues = allValues.concat(propertyValue);\n        }\n        this.urlComponents.oDataQueryParams[propertyName] += allValues.join(\",\");\n    }\n    /**\n     * @private\n     * Builds the full url from the URLComponents to make a request\n     * @returns The URL string that is qualified to make a request to graph endpoint\n     */\n    buildFullUrl() {\n        const url = urlJoin([this.urlComponents.host, this.urlComponents.version, this.urlComponents.path]) + this.createQueryString();\n        if (this.config.debugLogging) {\n            console.log(url);\n        }\n        return url;\n    }\n    /**\n     * @private\n     * Builds the query string from the URLComponents\n     * @returns The Constructed query string\n     */\n    createQueryString() {\n        // Combining query params from oDataQueryParams and otherURLQueryParams\n        const urlComponents = this.urlComponents;\n        const query = [];\n        if (Object.keys(urlComponents.oDataQueryParams).length !== 0) {\n            for (const property in urlComponents.oDataQueryParams) {\n                if (Object.prototype.hasOwnProperty.call(urlComponents.oDataQueryParams, property)) {\n                    query.push(property + \"=\" + urlComponents.oDataQueryParams[property]);\n                }\n            }\n        }\n        if (Object.keys(urlComponents.otherURLQueryParams).length !== 0) {\n            for (const property in urlComponents.otherURLQueryParams) {\n                if (Object.prototype.hasOwnProperty.call(urlComponents.otherURLQueryParams, property)) {\n                    query.push(property + \"=\" + urlComponents.otherURLQueryParams[property]);\n                }\n            }\n        }\n        if (urlComponents.otherURLQueryOptions.length !== 0) {\n            for (const str of urlComponents.otherURLQueryOptions) {\n                query.push(str);\n            }\n        }\n        return query.length > 0 ? \"?\" + query.join(\"&\") : \"\";\n    }\n    /**\n     * @private\n     * Parses the query parameters to set the urlComponents property of the GraphRequest object\n     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query parameter\n     * @returns The same GraphRequest instance that is being called with\n     */\n    parseQueryParameter(queryDictionaryOrString) {\n        if (typeof queryDictionaryOrString === \"string\") {\n            if (queryDictionaryOrString.charAt(0) === \"?\") {\n                queryDictionaryOrString = queryDictionaryOrString.substring(1);\n            }\n            if (queryDictionaryOrString.indexOf(\"&\") !== -1) {\n                const queryParams = queryDictionaryOrString.split(\"&\");\n                for (const str of queryParams) {\n                    this.parseQueryParamenterString(str);\n                }\n            }\n            else {\n                this.parseQueryParamenterString(queryDictionaryOrString);\n            }\n        }\n        else if (queryDictionaryOrString.constructor === Object) {\n            for (const key in queryDictionaryOrString) {\n                if (Object.prototype.hasOwnProperty.call(queryDictionaryOrString, key)) {\n                    this.setURLComponentsQueryParamater(key, queryDictionaryOrString[key]);\n                }\n            }\n        }\n        return this;\n    }\n    /**\n     * @private\n     * Parses the query parameter of string type to set the urlComponents property of the GraphRequest object\n     * @param {string} queryParameter - the query parameters\n     * returns nothing\n     */\n    parseQueryParamenterString(queryParameter) {\n        /* The query key-value pair must be split on the first equals sign to avoid errors in parsing nested query parameters.\n                 Example-> \"/me?$expand=home($select=city)\" */\n        if (this.isValidQueryKeyValuePair(queryParameter)) {\n            const indexOfFirstEquals = queryParameter.indexOf(\"=\");\n            const paramKey = queryParameter.substring(0, indexOfFirstEquals);\n            const paramValue = queryParameter.substring(indexOfFirstEquals + 1);\n            this.setURLComponentsQueryParamater(paramKey, paramValue);\n        }\n        else {\n            /* Push values which are not of key-value structure.\n            Example-> Handle an invalid input->.query(test), .query($select($select=name)) and let the Graph API respond with the error in the URL*/\n            this.urlComponents.otherURLQueryOptions.push(queryParameter);\n        }\n    }\n    /**\n     * @private\n     * Sets values into the urlComponents property of GraphRequest object.\n     * @param {string} paramKey - the query parameter key\n     * @param {string} paramValue - the query paramter value\n     * @returns nothing\n     */\n    setURLComponentsQueryParamater(paramKey, paramValue) {\n        if (oDataQueryNames.indexOf(paramKey) !== -1) {\n            const currentValue = this.urlComponents.oDataQueryParams[paramKey];\n            const isValueAppendable = currentValue && (paramKey === \"$expand\" || paramKey === \"$select\" || paramKey === \"$orderby\");\n            this.urlComponents.oDataQueryParams[paramKey] = isValueAppendable ? currentValue + \",\" + paramValue : paramValue;\n        }\n        else {\n            this.urlComponents.otherURLQueryParams[paramKey] = paramValue;\n        }\n    }\n    /**\n     * @private\n     * Check if the query parameter string has a valid key-value structure\n     * @param {string} queryString - the query parameter string. Example -> \"name=value\"\n     * #returns true if the query string has a valid key-value structure else false\n     */\n    isValidQueryKeyValuePair(queryString) {\n        const indexofFirstEquals = queryString.indexOf(\"=\");\n        if (indexofFirstEquals === -1) {\n            return false;\n        }\n        const indexofOpeningParanthesis = queryString.indexOf(\"(\");\n        if (indexofOpeningParanthesis !== -1 && queryString.indexOf(\"(\") < indexofFirstEquals) {\n            // Example -> .query($select($expand=true));\n            return false;\n        }\n        return true;\n    }\n    /**\n     * @private\n     * Updates the custom headers and options for a request\n     * @param {FetchOptions} options - The request options object\n     * @returns Nothing\n     */\n    updateRequestOptions(options) {\n        const optionsHeaders = Object.assign({}, options.headers);\n        if (this.config.fetchOptions !== undefined) {\n            const fetchOptions = Object.assign({}, this.config.fetchOptions);\n            Object.assign(options, fetchOptions);\n            if (typeof this.config.fetchOptions.headers !== undefined) {\n                options.headers = Object.assign({}, this.config.fetchOptions.headers);\n            }\n        }\n        Object.assign(options, this._options);\n        if (options.headers !== undefined) {\n            Object.assign(optionsHeaders, options.headers);\n        }\n        Object.assign(optionsHeaders, this._headers);\n        options.headers = optionsHeaders;\n    }\n    /**\n     * @private\n     * @async\n     * Adds the custom headers and options to the request and makes the HTTPClient send request call\n     * @param {RequestInfo} request - The request url string or the Request object value\n     * @param {FetchOptions} options - The options to make a request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the response content\n     */\n    send(request, options, callback) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            let rawResponse;\n            const middlewareControl = new MiddlewareControl(this._middlewareOptions);\n            this.updateRequestOptions(options);\n            const customHosts = (_a = this.config) === null || _a === void 0 ? void 0 : _a.customHosts;\n            try {\n                const context = yield this.httpClient.sendRequest({\n                    request,\n                    options,\n                    middlewareControl,\n                    customHosts,\n                });\n                rawResponse = context.response;\n                const response = yield GraphResponseHandler.getResponse(rawResponse, this._responseType, callback);\n                return response;\n            }\n            catch (error) {\n                if (error instanceof GraphClientError) {\n                    throw error;\n                }\n                let statusCode;\n                if (rawResponse) {\n                    statusCode = rawResponse.status;\n                }\n                const gError = yield GraphErrorHandler.getError(error, statusCode, callback, rawResponse);\n                throw gError;\n            }\n        });\n    }\n    /**\n     * @private\n     * Checks if the content-type is present in the _headers property. If not present, defaults the content-type to application/json\n     * @param none\n     * @returns nothing\n     */\n    setHeaderContentType() {\n        if (!this._headers) {\n            this.header(\"Content-Type\", \"application/json\");\n            return;\n        }\n        const headerKeys = Object.keys(this._headers);\n        for (const headerKey of headerKeys) {\n            if (headerKey.toLowerCase() === \"content-type\") {\n                return;\n            }\n        }\n        // Default the content-type to application/json in case the content-type is not present in the header\n        this.header(\"Content-Type\", \"application/json\");\n    }\n    /**\n     * @public\n     * Sets the custom header for a request\n     * @param {string} headerKey - A header key\n     * @param {string} headerValue - A header value\n     * @returns The same GraphRequest instance that is being called with\n     */\n    header(headerKey, headerValue) {\n        this._headers[headerKey] = headerValue;\n        return this;\n    }\n    /**\n     * @public\n     * Sets the custom headers for a request\n     * @param {KeyValuePairObjectStringNumber | HeadersInit} headers - The request headers\n     * @returns The same GraphRequest instance that is being called with\n     */\n    headers(headers) {\n        for (const key in headers) {\n            if (Object.prototype.hasOwnProperty.call(headers, key)) {\n                this._headers[key] = headers[key];\n            }\n        }\n        return this;\n    }\n    /**\n     * @public\n     * Sets the option for making a request\n     * @param {string} key - The key value\n     * @param {any} value - The value\n     * @returns The same GraphRequest instance that is being called with\n     */\n    option(key, value) {\n        this._options[key] = value;\n        return this;\n    }\n    /**\n     * @public\n     * Sets the options for making a request\n     * @param {{ [key: string]: any }} options - The options key value pair\n     * @returns The same GraphRequest instance that is being called with\n     */\n    options(options) {\n        for (const key in options) {\n            if (Object.prototype.hasOwnProperty.call(options, key)) {\n                this._options[key] = options[key];\n            }\n        }\n        return this;\n    }\n    /**\n     * @public\n     * Sets the middleware options for a request\n     * @param {MiddlewareOptions[]} options - The array of middleware options\n     * @returns The same GraphRequest instance that is being called with\n     */\n    middlewareOptions(options) {\n        this._middlewareOptions = options;\n        return this;\n    }\n    /**\n     * @public\n     * Sets the api endpoint version for a request\n     * @param {string} version - The version value\n     * @returns The same GraphRequest instance that is being called with\n     */\n    version(version) {\n        this.urlComponents.version = version;\n        return this;\n    }\n    /**\n     * @public\n     * Sets the api endpoint version for a request\n     * @param {ResponseType} responseType - The response type value\n     * @returns The same GraphRequest instance that is being called with\n     */\n    responseType(responseType) {\n        this._responseType = responseType;\n        return this;\n    }\n    /**\n     * @public\n     * To add properties for select OData Query param\n     * @param {string|string[]} properties - The Properties value\n     * @returns The same GraphRequest instance that is being called with, after adding the properties for $select query\n     */\n    /*\n     * Accepts .select(\"displayName,birthday\")\n     *     and .select([\"displayName\", \"birthday\"])\n     *     and .select(\"displayName\", \"birthday\")\n     *\n     */\n    select(properties) {\n        this.addCsvQueryParameter(\"$select\", properties, arguments);\n        return this;\n    }\n    /**\n     * @public\n     * To add properties for expand OData Query param\n     * @param {string|string[]} properties - The Properties value\n     * @returns The same GraphRequest instance that is being called with, after adding the properties for $expand query\n     */\n    expand(properties) {\n        this.addCsvQueryParameter(\"$expand\", properties, arguments);\n        return this;\n    }\n    /**\n     * @public\n     * To add properties for orderby OData Query param\n     * @param {string|string[]} properties - The Properties value\n     * @returns The same GraphRequest instance that is being called with, after adding the properties for $orderby query\n     */\n    orderby(properties) {\n        this.addCsvQueryParameter(\"$orderby\", properties, arguments);\n        return this;\n    }\n    /**\n     * @public\n     * To add query string for filter OData Query param. The request URL accepts only one $filter Odata Query option and its value is set to the most recently passed filter query string.\n     * @param {string} filterStr - The filter query string\n     * @returns The same GraphRequest instance that is being called with, after adding the $filter query\n     */\n    filter(filterStr) {\n        this.urlComponents.oDataQueryParams.$filter = filterStr;\n        return this;\n    }\n    /**\n     * @public\n     * To add criterion for search OData Query param. The request URL accepts only one $search Odata Query option and its value is set to the most recently passed search criterion string.\n     * @param {string} searchStr - The search criterion string\n     * @returns The same GraphRequest instance that is being called with, after adding the $search query criteria\n     */\n    search(searchStr) {\n        this.urlComponents.oDataQueryParams.$search = searchStr;\n        return this;\n    }\n    /**\n     * @public\n     * To add number for top OData Query param. The request URL accepts only one $top Odata Query option and its value is set to the most recently passed number value.\n     * @param {number} n - The number value\n     * @returns The same GraphRequest instance that is being called with, after adding the number for $top query\n     */\n    top(n) {\n        this.urlComponents.oDataQueryParams.$top = n;\n        return this;\n    }\n    /**\n     * @public\n     * To add number for skip OData Query param. The request URL accepts only one $skip Odata Query option and its value is set to the most recently passed number value.\n     * @param {number} n - The number value\n     * @returns The same GraphRequest instance that is being called with, after adding the number for the $skip query\n     */\n    skip(n) {\n        this.urlComponents.oDataQueryParams.$skip = n;\n        return this;\n    }\n    /**\n     * @public\n     * To add token string for skipToken OData Query param. The request URL accepts only one $skipToken Odata Query option and its value is set to the most recently passed token value.\n     * @param {string} token - The token value\n     * @returns The same GraphRequest instance that is being called with, after adding the token string for $skipToken query option\n     */\n    skipToken(token) {\n        this.urlComponents.oDataQueryParams.$skipToken = token;\n        return this;\n    }\n    /**\n     * @public\n     * To add boolean for count OData Query param. The URL accepts only one $count Odata Query option and its value is set to the most recently passed boolean value.\n     * @param {boolean} isCount - The count boolean\n     * @returns The same GraphRequest instance that is being called with, after adding the boolean value for the $count query option\n     */\n    count(isCount = true) {\n        this.urlComponents.oDataQueryParams.$count = isCount.toString();\n        return this;\n    }\n    /**\n     * @public\n     * Appends query string to the urlComponent\n     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query value\n     * @returns The same GraphRequest instance that is being called with, after appending the query string to the url component\n     */\n    /*\n     * Accepts .query(\"displayName=xyz\")\n     *     and .select({ name: \"value\" })\n     */\n    query(queryDictionaryOrString) {\n        return this.parseQueryParameter(queryDictionaryOrString);\n    }\n    /**\n     * @public\n     * @async\n     * Makes a http request with GET method\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the get response\n     */\n    get(callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            const options = {\n                method: RequestMethod.GET,\n            };\n            const response = yield this.send(url, options, callback);\n            return response;\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes a http request with POST method\n     * @param {any} content - The content that needs to be sent with the request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the post response\n     */\n    post(content, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            const options = {\n                method: RequestMethod.POST,\n                body: serializeContent(content),\n            };\n            const className = content && content.constructor && content.constructor.name;\n            if (className === \"FormData\") {\n                // Content-Type headers should not be specified in case the of FormData type content\n                options.headers = {};\n            }\n            else {\n                this.setHeaderContentType();\n                options.headers = this._headers;\n            }\n            return yield this.send(url, options, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Alias for Post request call\n     * @param {any} content - The content that needs to be sent with the request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the post response\n     */\n    create(content, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.post(content, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes http request with PUT method\n     * @param {any} content - The content that needs to be sent with the request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the put response\n     */\n    put(content, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            this.setHeaderContentType();\n            const options = {\n                method: RequestMethod.PUT,\n                body: serializeContent(content),\n            };\n            return yield this.send(url, options, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes http request with PATCH method\n     * @param {any} content - The content that needs to be sent with the request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the patch response\n     */\n    patch(content, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            this.setHeaderContentType();\n            const options = {\n                method: RequestMethod.PATCH,\n                body: serializeContent(content),\n            };\n            return yield this.send(url, options, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Alias for PATCH request\n     * @param {any} content - The content that needs to be sent with the request\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the patch response\n     */\n    update(content, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.patch(content, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes http request with DELETE method\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the delete response\n     */\n    delete(callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            const options = {\n                method: RequestMethod.DELETE,\n            };\n            return yield this.send(url, options, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Alias for delete request call\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the delete response\n     */\n    del(callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.delete(callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes a http request with GET method to read response as a stream.\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the getStream response\n     */\n    getStream(callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            const options = {\n                method: RequestMethod.GET,\n            };\n            this.responseType(ResponseType.STREAM);\n            return yield this.send(url, options, callback);\n        });\n    }\n    /**\n     * @public\n     * @async\n     * Makes a http request with GET method to read response as a stream.\n     * @param {any} stream - The stream instance\n     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call\n     * @returns A promise that resolves to the putStream response\n     */\n    putStream(stream, callback) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const url = this.buildFullUrl();\n            const options = {\n                method: RequestMethod.PUT,\n                headers: {\n                    \"Content-Type\": \"application/octet-stream\",\n                },\n                body: stream,\n            };\n            return yield this.send(url, options, callback);\n        });\n    }\n}\n//# sourceMappingURL=GraphRequest.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @class\n * Class representing HTTPClient\n */\nexport class HTTPClient {\n    /**\n     * @public\n     * @constructor\n     * Creates an instance of a HTTPClient\n     * @param {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers\n     */\n    constructor(...middleware) {\n        if (!middleware || !middleware.length) {\n            const error = new Error();\n            error.name = \"InvalidMiddlewareChain\";\n            error.message = \"Please provide a default middleware chain or custom middleware chain\";\n            throw error;\n        }\n        this.setMiddleware(...middleware);\n    }\n    /**\n     * @private\n     * Processes the middleware parameter passed to set this.middleware property\n     * The calling function should validate if middleware is not undefined or not empty.\n     * @param {...Middleware} middleware - The middleware passed\n     * @returns Nothing\n     */\n    setMiddleware(...middleware) {\n        if (middleware.length > 1) {\n            this.parseMiddleWareArray(middleware);\n        }\n        else {\n            this.middleware = middleware[0];\n        }\n    }\n    /**\n     * @private\n     * Processes the middleware array to construct the chain\n     * and sets this.middleware property to the first middleware handler of the array\n     * The calling function should validate if middleware is not undefined or not empty\n     * @param {Middleware[]} middlewareArray - The array of middleware handlers\n     * @returns Nothing\n     */\n    parseMiddleWareArray(middlewareArray) {\n        middlewareArray.forEach((element, index) => {\n            if (index < middlewareArray.length - 1) {\n                element.setNext(middlewareArray[index + 1]);\n            }\n        });\n        this.middleware = middlewareArray[0];\n    }\n    /**\n     * @public\n     * @async\n     * To send the request through the middleware chain\n     * @param {Context} context - The context of a request\n     * @returns A promise that resolves to the Context\n     */\n    sendRequest(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof context.request === \"string\" && context.options === undefined) {\n                const error = new Error();\n                error.name = \"InvalidRequestOptions\";\n                error.message = \"Unable to execute the middleware, Please provide valid options for a request\";\n                throw error;\n            }\n            yield this.middleware.execute(context);\n            return context;\n        });\n    }\n}\n//# sourceMappingURL=HTTPClient.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { __awaiter } from \"tslib\";\n/**\n * @class\n * @implements Middleware\n * Class for HTTPMessageHandler\n */\nexport class HTTPMessageHandler {\n    /**\n     * @public\n     * @async\n     * To execute the current middleware\n     * @param {Context} context - The request context object\n     * @returns A promise that resolves to nothing\n     */\n    execute(context) {\n        return __awaiter(this, void 0, void 0, function* () {\n            context.response = yield fetch(context.request, context.options);\n        });\n    }\n}\n//# sourceMappingURL=HTTPMessageHandler.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module HTTPClientFactory\n */\nimport { HTTPClient } from \"./HTTPClient\";\nimport { AuthenticationHandler } from \"./middleware/AuthenticationHandler\";\nimport { HTTPMessageHandler } from \"./middleware/HTTPMessageHandler\";\nimport { RedirectHandlerOptions } from \"./middleware/options/RedirectHandlerOptions\";\nimport { RetryHandlerOptions } from \"./middleware/options/RetryHandlerOptions\";\nimport { RedirectHandler } from \"./middleware/RedirectHandler\";\nimport { RetryHandler } from \"./middleware/RetryHandler\";\nimport { TelemetryHandler } from \"./middleware/TelemetryHandler\";\n/**\n * @private\n * To check whether the environment is node or not\n * @returns A boolean representing the environment is node or not\n */\nconst isNodeEnvironment = () => {\n    return typeof process === \"object\" && typeof require === \"function\";\n};\n/**\n * @class\n * Class representing HTTPClientFactory\n */\nexport class HTTPClientFactory {\n    /**\n     * @public\n     * @static\n     * Creates HTTPClient with default middleware chain\n     * @param {AuthenticationProvider} authProvider - The authentication provider instance\n     * @returns A HTTPClient instance\n     *\n     * NOTE: These are the things that we need to remember while doing modifications in the below default pipeline.\n     * \t\t* HTTPMessageHandler should be the last one in the middleware pipeline, because this makes the actual network call of the request\n     * \t\t* TelemetryHandler should be the one prior to the last middleware in the chain, because this is the one which actually collects and appends the usage flag and placing this handler \t*\t\t  before making the actual network call ensures that the usage of all features are recorded in the flag.\n     * \t\t* The best place for AuthenticationHandler is in the starting of the pipeline, because every other handler might have to work for multiple times for a request but the auth token for\n     * \t\t  them will remain same. For example, Retry and Redirect handlers might be working multiple times for a request based on the response but their auth token would remain same.\n     */\n    static createWithAuthenticationProvider(authProvider) {\n        const authenticationHandler = new AuthenticationHandler(authProvider);\n        const retryHandler = new RetryHandler(new RetryHandlerOptions());\n        const telemetryHandler = new TelemetryHandler();\n        const httpMessageHandler = new HTTPMessageHandler();\n        authenticationHandler.setNext(retryHandler);\n        if (isNodeEnvironment()) {\n            const redirectHandler = new RedirectHandler(new RedirectHandlerOptions());\n            retryHandler.setNext(redirectHandler);\n            redirectHandler.setNext(telemetryHandler);\n        }\n        else {\n            retryHandler.setNext(telemetryHandler);\n        }\n        telemetryHandler.setNext(httpMessageHandler);\n        return HTTPClientFactory.createWithMiddleware(authenticationHandler);\n    }\n    /**\n     * @public\n     * @static\n     * Creates a middleware chain with the given one\n     * @property {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers\n     * @returns A HTTPClient instance\n     */\n    static createWithMiddleware(...middleware) {\n        // Middleware should not empty or undefined. This is check is present in the HTTPClient constructor.\n        return new HTTPClient(...middleware);\n    }\n}\n//# sourceMappingURL=HTTPClientFactory.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @module Client\n */\nimport { GRAPH_API_VERSION, GRAPH_BASE_URL } from \"./Constants\";\nimport { CustomAuthenticationProvider } from \"./CustomAuthenticationProvider\";\nimport { GraphRequest } from \"./GraphRequest\";\nimport { HTTPClient } from \"./HTTPClient\";\nimport { HTTPClientFactory } from \"./HTTPClientFactory\";\nimport { validatePolyFilling } from \"./ValidatePolyFilling\";\nexport class Client {\n    /**\n     * @public\n     * @static\n     * To create a client instance with options and initializes the default middleware chain\n     * @param {Options} options - The options for client instance\n     * @returns The Client instance\n     */\n    static init(options) {\n        const clientOptions = {};\n        for (const i in options) {\n            if (Object.prototype.hasOwnProperty.call(options, i)) {\n                clientOptions[i] = i === \"authProvider\" ? new CustomAuthenticationProvider(options[i]) : options[i];\n            }\n        }\n        return Client.initWithMiddleware(clientOptions);\n    }\n    /**\n     * @public\n     * @static\n     * To create a client instance with the Client Options\n     * @param {ClientOptions} clientOptions - The options object for initializing the client\n     * @returns The Client instance\n     */\n    static initWithMiddleware(clientOptions) {\n        return new Client(clientOptions);\n    }\n    /**\n     * @private\n     * @constructor\n     * Creates an instance of Client\n     * @param {ClientOptions} clientOptions - The options to instantiate the client object\n     */\n    constructor(clientOptions) {\n        /**\n         * @private\n         * A member which stores the Client instance options\n         */\n        this.config = {\n            baseUrl: GRAPH_BASE_URL,\n            debugLogging: false,\n            defaultVersion: GRAPH_API_VERSION,\n        };\n        validatePolyFilling();\n        for (const key in clientOptions) {\n            if (Object.prototype.hasOwnProperty.call(clientOptions, key)) {\n                this.config[key] = clientOptions[key];\n            }\n        }\n        let httpClient;\n        if (clientOptions.authProvider !== undefined && clientOptions.middleware !== undefined) {\n            const error = new Error();\n            error.name = \"AmbiguityInInitialization\";\n            error.message = \"Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both\";\n            throw error;\n        }\n        else if (clientOptions.authProvider !== undefined) {\n            httpClient = HTTPClientFactory.createWithAuthenticationProvider(clientOptions.authProvider);\n        }\n        else if (clientOptions.middleware !== undefined) {\n            httpClient = new HTTPClient(...[].concat(clientOptions.middleware));\n        }\n        else {\n            const error = new Error();\n            error.name = \"InvalidMiddlewareChain\";\n            error.message = \"Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain\";\n            throw error;\n        }\n        this.httpClient = httpClient;\n    }\n    /**\n     * @public\n     * Entry point to make requests\n     * @param {string} path - The path string value\n     * @returns The graph request instance\n     */\n    api(path) {\n        return new GraphRequest(this.httpClient, this.config, path);\n    }\n}\n//# sourceMappingURL=Client.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/**\n * @constant\n * @function\n * Validates availability of Promise and fetch in global context\n * @returns The true in case the Promise and fetch available, otherwise throws error\n */\nexport const validatePolyFilling = () => {\n    if (typeof Promise === \"undefined\" && typeof fetch === \"undefined\") {\n        const error = new Error(\"Library cannot function without Promise and fetch. So, please provide polyfill for them.\");\n        error.name = \"PolyFillNotAvailable\";\n        throw error;\n    }\n    else if (typeof Promise === \"undefined\") {\n        const error = new Error(\"Library cannot function without Promise. So, please provide polyfill for it.\");\n        error.name = \"PolyFillNotAvailable\";\n        throw error;\n    }\n    else if (typeof fetch === \"undefined\") {\n        const error = new Error(\"Library cannot function without fetch. So, please provide polyfill for it.\");\n        error.name = \"PolyFillNotAvailable\";\n        throw error;\n    }\n    return true;\n};\n//# sourceMappingURL=ValidatePolyFilling.js.map","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\nimport { Client } from \"@microsoft/microsoft-graph-client\";\n\n/* global Office */\nOffice.onReady();\nclass OfficeAuthProvider {\n  async getAccessToken(AuthenticationProviderOptions) {\n    return Office.auth.getAccessToken({\n      allowConsentPrompt: true,\n      allowSignInPrompt: true,\n      forMSGraphAccess: true,\n    });\n  }\n}\n\nconst authProvider = new OfficeAuthProvider();\nconst client = Client.initWithMiddleware({\n  authProvider: authProvider,\n});\n\nasync function claimEmail() {\n  console.log(\"Claiming Email...\");\n  //Get currently selected message reference\n  const message = Office.context.mailbox.item;\n  if (message == undefined || message.internetMessageId.length == 0 || message.itemId.length == 0) return;\n  const comment = \"Claiming email:\" + message.internetMessageId;\n  //TODO: Determine if the message is claimed already\n  //Convert the message EWS ID to REST ID\n  const messageRestID = Office.context.mailbox.convertToRestId(message.itemId, Office.MailboxEnums.RestVersion.v2_0);\n  //Check to see if we are in a shared inbox\n  if (message.getSharedPropertiesAsync) {\n    try {\n      //\"/users/\" + this.sharedMailboxId + \"/messages/\" + msgRestID + \"/forward\"\n      await client.api(\"/users/techsupport@sjcd.edu/\" + messageRestID).update({\n        flag: {\n          flagStatus: \"flagged\",\n        },\n      });\n      await client.api(\"/users/techsupport@sjcd.edu/\" + messageRestID + \"/forward\").post({\n        comment: comment,\n        toRecipients: [\n          {\n            emailAddress: {\n              name: \"San Jacinto College Tech Support\",\n              address: \"techsupport@sjcd.edu\",\n            },\n          },\n        ],\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  } else {\n    const forward = {\n      comment: comment,\n      toRecipients: [\n        {\n          emailAddress: {\n            name: \"Jose Mendez\",\n            address: \"jose.mendez@sjcd.edu\",\n          },\n        },\n      ],\n    };\n    try {\n      //\"/users/\" + this.sharedMailboxId + \"/messages/\" + msgRestID + \"/forward\"\n      client.api(\"/me/messages/\" + messageRestID).update({\n        flag: {\n          flagStatus: \"flagged\",\n        },\n      });\n      await client.api(\"/me/messages/\" + messageRestID + \"/forward\").post(forward);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  console.log(\"Email successfully claimed!\");\n}\nfunction getAgentName() {\n  let fullName = Office.context.mailbox.userProfile.displayName;\n  return fullName.split(\",\")[1] + \" \" + fullName.split(\",\")[0];\n}\nOffice.actions.associate(\"claimEmail\", claimEmail);\n","// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./commands.js\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \"@@ -1,18 +0,0 @@ <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\"><\" + \"/script> </head> <body> </body> </html>\";\n// Exports\nexport default code;"],"names":["module","exports","isFunction","x","isArray","Array","Object","prototype","toString","call","len","vertxNext","customSchedulerFn","asap","callback","arg","queue","flush","scheduleFlush","browserWindow","window","undefined","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","self","process","isWorker","Uint8ClampedArray","importScripts","MessageChannel","useSetTimeout","globalSetTimeout","setTimeout","i","channel","iterations","observer","node","then","onFulfillment","onRejection","parent","this","child","constructor","noop","PROMISE_ID","makePromise","_state","arguments","invokeCallback","_result","subscribe","resolve$1","object","promise","resolve","nextTick","document","createTextNode","observe","characterData","data","port1","onmessage","port2","postMessage","vertx","Function","require","runOnLoop","runOnContext","e","attemptVertx","Math","random","substring","PENDING","FULFILLED","REJECTED","handleMaybeThenable","maybeThenable","then$$1","thenable","fulfill","reject","value","reason","handleOwnThenable","sealed","error","fulfillmentHandler","rejectionHandler","tryThen","_label","handleForeignThenable","TypeError","type","publishRejection","_onerror","publish","_subscribers","length","subscribers","settled","detail","hasCallback","succeeded","id","Enumerator","Constructor","input","_instanceConstructor","_remaining","_enumerate","Error","_eachEntry","entry","c","resolve$$1","_then","didError","_settledAt","Promise$1","_willSettleAt","state","enumerator","Promise","resolver","needsResolver","initializePromise","needsNew","catch","finally","all","entries","race","_","_setScheduler","scheduleFn","_setAsap","asapFn","_asap","polyfill","local","g","P","promiseToString","cast","factory","url","options","String","__esModule","default","hash","maybeNeedQuotes","test","concat","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","n","getter","d","a","definition","key","o","defineProperty","enumerable","get","globalThis","obj","prop","hasOwnProperty","scriptUrl","location","currentScript","src","scripts","getElementsByTagName","replace","p","b","baseURI","href","RequestMethod","thisArg","_arguments","generator","fulfilled","step","next","rejected","result","done","apply","create","SuppressedError","BatchRequestContent","validateDependencies","requests","size","name","reqs","iterator","cur","curReq","dependsOn","isParallel","firstRequest","prev","isSerial","dependencyId","fDependencyId","has","isSame","getRequestData","request","requestData","hasHttpRegex","RegExp","split","method","headers","forEach","keys","PATCH","POST","PUT","body","getRequestBody","bodyParsed","cloneReq","clone","json","Blob","blob","reader","FileReader","addEventListener","dataURL","segments","exec","readAsDataURL","Buffer","buffer","Map","limit","requestLimit","req","addRequest","set","removeRequest","requestId","deleteStatus","delete","dependencies","index","indexOf","splice","getContent","requestBody","requestStep","batchRequestData","push","addDependency","dependentId","dependent","dId","removeDependency","GRAPH_URLS","Set","setGraphClientError","graphClientError","customError","message","super","setPrototypeOf","oDataQueryNames","serializeContent","content","className","from","JSON","stringify","isGraphURL","isValidEndpoint","isCustomHost","customHosts","host","isCustomHostValid","allowedHosts","toLowerCase","startofPortNoPos","endOfHostStrPos","hostName","middlewareOptions","option","fn","getMiddlewareOptions","setMiddlewareOptions","getRequestHeader","Request","Headers","l","setRequestHeader","header","assign","appendRequestHeader","append","AuthenticationHandlerOptions","authenticationProvider","authenticationProviderOptions","FeatureUsageFlag","TelemetryHandlerOptions","featureUsage","NONE","updateFeatureUsageFlag","context","flag","middlewareControl","setFeatureUsage","getFeatureUsage","execute","bearerKey","getAccessToken","AUTHORIZATION_HEADER","AUTHENTICATION_HANDLER_ENABLED","nextMiddleware","setNext","delay","DEFAULT_DELAY","maxRetries","DEFAULT_MAX_RETRIES","shouldRetry","defaultShouldRetry","MAX_DELAY","MAX_MAX_RETRIES","min","getMaxDelay","ChaosStrategy","ResponseType","isRetry","response","RETRY_STATUS_CODES","status","isBuffered","getDelay","retryAttempts","getRandomness","Number","toFixed","retryAfter","RETRY_AFTER_HEADER","newDelay","isNaN","round","Date","getTime","now","getExponentialBackOffTime","attempts","pow","sleep","delaySeconds","delayMilliseconds","getOptions","executeWithRetry","RETRY_ATTEMPT_HEADER","RETRY_HANDLER_ENABLED","maxRedirects","DEFAULT_MAX_REDIRECTS","shouldRedirect","defaultShouldRedirect","MAX_MAX_REDIRECTS","isRedirect","REDIRECT_STATUS_CODES","hasLocationHeader","LOCATION_HEADER","getLocationHeader","isRelativeURL","shouldDropAuthorizationHeader","requestUrl","redirectUrl","schemeHostRegex","requestMatches","requestAuthority","redirectAuthority","redirectMatches","updateRequestUrl","newUrl","referrer","referrerPolicy","mode","credentials","cache","redirect","integrity","keepalive","signal","executeWithRedirect","redirectCount","STATUS_CODE_SEE_OTHER","GET","MANUAL_REDIRECT","REDIRECT_HANDLER_ENABLED","clientRequestId","CLIENT_REQUEST_ID_HEADER","uuid","j","floor","sdkVersionValue","PRODUCT_NAME","FEATURE_USAGE_STRING","SDK_VERSION_HEADER","DocumentType","ContentType","ContentTypeRegexStr","GraphResponseHandler","parseDocumentResponse","rawResponse","DOMParser","text","xmlString","xmlDoc","parseFromString","convertResponse","responseType","responseValue","contentType","ARRAYBUFFER","arrayBuffer","BLOB","DOCUMENT","TEXT_XML","STREAM","TEXT","mimeType","IMAGE","TEXT_PLAIN","APPLICATION_JSON","getResponse","RAW","ok","Range","minVal","maxVal","minValue","maxValue","UploadResult","_location","responseBody","_responseBody","CreateUploadResult","responseHeaders","LargeFileUploadTask","createUploadSession","client","payload","session","api","post","uploadUrl","expiry","expirationDateTime","isCancelled","file","uploadSession","DEFAULT_FILE_SIZE","sliceFile","rangeSize","nextRange","parseRange","ranges","rangeStr","firstRange","parseInt","updateTaskStatus","nextExpectedRanges","getNextRange","range","console","warn","ArrayBuffer","Uint8Array","slice","upload","uploadEventHandlers","err","fileSlice","uploadSliceGetRawResponse","reportProgress","res","ExpirationDateTime","NextExpectedRanges","progress","extraCallbackParam","uploadSlice","totalSize","put","cancel","cancelResponse","getStatus","resume","getUploadSession","FileUpload","OneDriveLargeFileUploadTask","constructCreateSessionUrl","fileName","path","DEFAULT_UPLOAD_PATH","trim","map","encodeURIComponent","join","getFileInfo","File","byteLength","byteOffset","fileInfo","fileObj","createTaskWithFileObject","fileObject","uploadSessionURL","uploadSessionPayload","fileDescription","conflictBehavior","sixtyMB","getValidRangeSize","payloadOptions","_super","item","description","commit","CustomAuthenticationProvider","provider","accessToken","GraphError","statusCode","baseError","code","date","stack","GraphErrorHandler","constructError","gError","constructErrorFromResponse","graphError","innerError","getError","GraphRequest","httpClient","config","parsePath","urlComponents","endOfVersionStrPos","version","charAt","substr","queryStrPos","queryParams","queryParam","parseQueryParameter","baseUrl","defaultVersion","oDataQueryParams","otherURLQueryParams","otherURLQueryOptions","_headers","_options","_middlewareOptions","addCsvQueryParameter","propertyName","propertyValue","additionalProperties","allValues","buildFullUrl","urlSegments","removePreSlash","s","reduce","pre","urlJoin","createQueryString","debugLogging","log","query","property","str","queryDictionaryOrString","parseQueryParamenterString","setURLComponentsQueryParamater","queryParameter","isValidQueryKeyValuePair","indexOfFirstEquals","paramKey","paramValue","currentValue","isValueAppendable","queryString","indexofFirstEquals","updateRequestOptions","optionsHeaders","fetchOptions","send","_a","sendRequest","_responseType","setHeaderContentType","headerKeys","headerKey","headerValue","select","properties","expand","orderby","filter","filterStr","$filter","search","searchStr","$search","top","$top","skip","$skip","skipToken","token","$skipToken","count","isCount","$count","patch","update","DELETE","del","getStream","putStream","stream","HTTPClient","middleware","setMiddleware","parseMiddleWareArray","middlewareArray","element","fetch","HTTPClientFactory","createWithAuthenticationProvider","authProvider","authenticationHandler","retryHandler","telemetryHandler","httpMessageHandler","redirectHandler","createWithMiddleware","Client","init","clientOptions","initWithMiddleware","validatePolyFilling","_regeneratorRuntime","t","r","Symbol","asyncIterator","u","toStringTag","define","configurable","writable","wrap","Generator","Context","makeInvokeMethod","tryCatch","h","f","y","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","v","values","defineIteratorMethods","_invoke","AsyncIterator","invoke","_typeof","__await","callInvokeWithMethodAndArg","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","displayName","isGeneratorFunction","mark","__proto__","awrap","async","reverse","pop","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","gen","_next","_throw","info","_asyncToGenerator","args","_defineProperties","target","props","descriptor","_toPropertyKey","toPrimitive","_toPrimitive","Office","onReady","OfficeAuthProvider","instance","_classCallCheck","protoProps","_getAccessToken","_callee","AuthenticationProviderOptions","_context","auth","allowConsentPrompt","allowSignInPrompt","forMSGraphAccess","_x","_claimEmail","_callee2","comment","messageRestID","forward","_context2","mailbox","internetMessageId","itemId","convertToRestId","MailboxEnums","RestVersion","v2_0","getSharedPropertiesAsync","flagStatus","toRecipients","emailAddress","address","t0","t1","actions","associate","___HTML_LOADER_IMPORT_0___","URL"],"sourceRoot":""}