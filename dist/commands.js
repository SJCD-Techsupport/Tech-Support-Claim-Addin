/*! For license information please see commands.js.LICENSE.txt */
!function(){var e={64583:function(e,t,r){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,i=void 0,o=void 0,s=function(e,t){p[n]=e,p[n+1]=t,2===(n+=2)&&(o?o(f):E())};var a="undefined"!=typeof window?window:void 0,c=a||{},u=c.MutationObserver||c.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(f,1)}}var p=new Array(1e3);function f(){for(var e=0;e<n;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;n=0}var y,m,v,g,E=void 0;function w(e,t){var r=this,n=new this.constructor(A);void 0===n[R]&&I(n);var i=r._state;if(i){var o=arguments[i-1];s((function(){return U(i,n,o,r._result)}))}else L(r,n,e,t);return n}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return D(t,e),t}E=d?function(){return process.nextTick(f)}:u?(m=0,v=new u(f),g=document.createTextNode(""),v.observe(g,{characterData:!0}),function(){g.data=m=++m%2}):l?((y=new MessageChannel).port1.onmessage=f,function(){return y.port2.postMessage(0)}):void 0===a?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(f)}:h()}catch(e){return h()}}():h();var R=Math.random().toString(36).substring(2);function A(){}var O=void 0,_=1,x=2;function T(t,r,n){r.constructor===t.constructor&&n===w&&r.constructor.resolve===b?function(e,t){t._state===_?P(e,t._result):t._state===x?C(e,t._result):L(t,void 0,(function(t){return D(e,t)}),(function(t){return C(e,t)}))}(t,r):void 0===n?P(t,r):e(n)?function(e,t,r){s((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?D(e,r):P(e,r))}),(function(t){n||(n=!0,C(e,t))}),e._label);!n&&i&&(n=!0,C(e,i))}),e)}(t,r,n):P(t,r)}function D(e,t){if(e===t)C(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)P(e,t);else{var r=void 0;try{r=t.then}catch(t){return void C(e,t)}T(e,t,r)}var n,i}function S(e){e._onerror&&e._onerror(e._result),M(e)}function P(e,t){e._state===O&&(e._result=t,e._state=_,0!==e._subscribers.length&&s(M,e))}function C(e,t){e._state===O&&(e._state=x,e._result=t,s(S,e))}function L(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+_]=r,i[o+x]=n,0===o&&e._state&&s(M,e)}function M(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?U(r,n,i,o):i(o);e._subscribers.length=0}}function U(t,r,n,i){var o=e(n),s=void 0,a=void 0,c=!0;if(o){try{s=n(i)}catch(e){c=!1,a=e}if(r===s)return void C(r,new TypeError("A promises callback cannot return that same promise."))}else s=i;r._state!==O||(o&&c?D(r,s):!1===c?C(r,a):t===_?P(r,s):t===x&&C(r,s))}var N=0;function I(e){e[R]=N++,e._state=void 0,e._result=void 0,e._subscribers=[]}var q=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(A),this.promise[R]||I(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&P(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===O&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===b){var i=void 0,o=void 0,s=!1;try{i=e.then}catch(e){s=!0,o=e}if(i===w&&e._state!==O)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===F){var a=new r(A);s?C(a,o):T(a,e,i),this._willSettleAt(a,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===O&&(this._remaining--,e===x?C(n,r):this._result[t]=r),0===this._remaining&&P(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;L(e,void 0,(function(e){return r._settledAt(_,t,e)}),(function(e){return r._settledAt(x,t,e)}))},e}();var F=function(){function t(e){this[R]=N++,this._result=this._state=void 0,this._subscribers=[],A!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){D(e,t)}),(function(t){C(e,t)}))}catch(t){C(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this,n=r.constructor;return e(t)?r.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):r.then(t,t)},t}();return F.prototype.then=w,F.all=function(e){return new q(this,e).promise},F.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var i=e.length,o=0;o<i;o++)r.resolve(e[o]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},F.resolve=b,F.reject=function(e){var t=new this(A);return C(t,e),t},F._setScheduler=function(e){o=e},F._setAsap=function(e){s=e},F._asap=s,F.polyfill=function(){var e=void 0;if(void 0!==r.g)e=r.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=F},F.Promise=F,F}()},14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98759:function(e,t,r){"use strict";e.exports=r.p+"aa339945526b6392a150.js"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r.b=document.baseURI||self.location.href,function(){"use strict";var e,t=r(64583).Promise;function n(e,r,n,i){return new(n||(n=t))((function(t,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,a)}c((i=i.apply(e,r||[])).next())}))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(e||(e={}));var i=r(64583).Promise;class o{static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let r=t.next();for(;!r.done;){const e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;let i=r;for(r=t.next();!r.done;){const e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=r,r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const n=r.value[1];let i;if(void 0===n.dependsOn||0===n.dependsOn.length)i=n.id;else{if(1!==n.dependsOn.length)return!1;{const t=n.dependsOn[0];if(t===n.id||!e.has(t))return!1;i=t}}for(r=t.next();!r.done;){const e=r.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&i!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===i||e.dependsOn[0]!==i))return!1;if(e.dependsOn.length>1)return!1}r=t.next()}return!0})(e)}static getRequestData(t){return n(this,void 0,void 0,(function*(){const r={url:""},n=new RegExp("^https?://");r.url=n.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,r.method=t.method;const i={};return t.headers.forEach(((e,t)=>{i[t]=e})),Object.keys(i).length&&(r.headers=i),t.method!==e.PATCH&&t.method!==e.POST&&t.method!==e.PUT||(r.body=yield o.getRequestBody(t)),r}))}static getRequestBody(e){return n(this,void 0,void 0,(function*(){let t,r=!1;try{const n=e.clone();t=yield n.json(),r=!0}catch(e){}if(!r)try{if("undefined"!=typeof Blob){const r=yield e.blob(),n=new FileReader;t=yield new i((e=>{n.addEventListener("load",(()=>{const t=n.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),n.readAsDataURL(r)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));r=!0}catch(e){}return t}))}constructor(e){if(this.requests=new Map,void 0!==e){const t=o.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}addRequest(e){const t=o.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),r=this.requests.entries();let n=r.next();for(;!n.done;){const t=n.value[1].dependsOn;if(void 0!==t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete n.value[1].dependsOn}n=r.next()}return t}getContent(){return n(this,void 0,void 0,(function*(){const e=[],t={requests:e},r=this.requests.entries();let n=r.next();if(n.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!o.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!n.done;){const t=n.value[1],i=yield o.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),n=r.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{const r=this.requests.entries();let n,i=r.next();for(;!i.done&&i.value[1].id!==e;)n=i,i=r.next();if(void 0===n){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=n.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}i.value[1].dependsOn.push(t)}}}removeDependency(e,t){const r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){const e=r.dependsOn.indexOf(t);return-1!==e&&(r.dependsOn.splice(e,1),!0)}return delete r.dependsOn,!0}}o.requestLimit=20;const s=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class a extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new a,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}const c=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},d=e=>h(e),l=(e,t)=>(t.forEach((e=>p(e))),h(e,t)),h=(e,t=s)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const r=(e=e.replace("https://","")).indexOf(":"),n=e.indexOf("/");let i="";if(-1!==n)return-1!==r&&r<n?(i=e.substring(0,r),t.has(i)):(i=e.substring(0,n),t.has(i))}return!1},p=e=>{if(-1!==e.indexOf("/"))throw new a("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class f{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}var y=r(64583).Promise;const m=(e,t,r)=>{let n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===r){n=e[t][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},v=(e,t,r,n)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[r]:n});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){let e=0;const i=t.headers.length;for(;e<i;e++){const i=t.headers[e];if(i[0]===r){i[1]=n;break}}e===i&&t.headers.push([r,n])}else Object.assign(t.headers,{[r]:n})},g=(e,t,r,n)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:n}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers={[r]:n}:void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=`, ${n}`)};class E{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var w;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(w||(w={}));class b{constructor(){this.featureUsage=w.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof f?r=e.middlewareControl.getMiddlewareOptions(b):e.middlewareControl=new f,void 0===r&&(r=new b,e.middlewareControl.setMiddlewareOptions(b,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class R{constructor(e){this.authenticationProvider=e}execute(e){return n(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&l(t,e.customHosts)){let t,r,n;e.middlewareControl instanceof f&&(t=e.middlewareControl.getMiddlewareOptions(E)),t&&(r=t.authenticationProvider,n=t.authenticationProviderOptions),r||(r=this.authenticationProvider);const i=`Bearer ${yield r.getAccessToken(n)}`;g(e.request,e.options,R.AUTHORIZATION_HEADER,i),b.updateFeatureUsageFlag(e,w.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[R.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}R.AUTHORIZATION_HEADER="Authorization";class A{constructor(e=A.DEFAULT_DELAY,t=A.DEFAULT_MAX_RETRIES,r=A.defaultShouldRetry){if(e>A.MAX_DELAY&&t>A.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${A.MAX_DELAY} and ${A.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>A.MAX_DELAY){const e=new Error(`Delay should not be more than ${A.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>A.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${A.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,A.MAX_DELAY),this.maxRetries=Math.min(t,A.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return A.MAX_DELAY}}A.DEFAULT_DELAY=3,A.DEFAULT_MAX_RETRIES=3,A.MAX_DELAY=180,A.MAX_MAX_RETRIES=10,A.defaultShouldRetry=()=>!0;var O,_,x,T=r(64583).Promise;class D{constructor(e=new A){this.options=e}isRetry(e){return-1!==D.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(t,r){const n="string"==typeof t?r.method:t.method;return n!==e.PUT&&n!==e.PATCH&&n!==e.POST||"application/octet-stream"!==m(t,r,"Content-Type")}getDelay(e,t,r){const n=()=>Number(Math.random().toFixed(3)),i=void 0!==e.headers?e.headers.get(D.RETRY_AFTER_HEADER):null;let o;return o=null!==i?Number.isNaN(Number(i))?Math.round((new Date(i).getTime()-Date.now())/1e3):Number(i):t>=2?this.getExponentialBackOffTime(t)+r+n():r+n(),Math.min(o,this.options.getMaxDelay()+n())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return n(this,void 0,void 0,(function*(){const t=1e3*e;return new T((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof f&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new A,this.options)),t}executeWithRetry(e,t,r){return n(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,v(e.request,e.options,D.RETRY_ATTEMPT_HEADER,t.toString());const n=this.getDelay(e.response,t,r.delay);return yield this.sleep(n),yield this.executeWithRetry(e,t,r)}}))}execute(e){return n(this,void 0,void 0,(function*(){const t=this.getOptions(e);return b.updateFeatureUsageFlag(e,w.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}D.RETRY_STATUS_CODES=[429,503,504],D.RETRY_ATTEMPT_HEADER="Retry-Attempt",D.RETRY_AFTER_HEADER="Retry-After";class S{constructor(e=S.DEFAULT_MAX_REDIRECTS,t=S.defaultShouldRedirect){if(e>S.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${S.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}S.DEFAULT_MAX_REDIRECTS=5,S.MAX_MAX_REDIRECTS=20,S.defaultShouldRedirect=()=>!0;class P{constructor(e=new S){this.options=e}isRedirect(e){return-1!==P.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(P.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(P.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,n=r.exec(e);let i,o;null!==n&&(i=n[0]);const s=r.exec(t);return null!==s&&(o=s[0]),void 0!==i&&void 0!==o&&i!==o}updateRequestUrl(e,t){return n(this,void 0,void 0,(function*(){var r,i;t.request="string"==typeof t.request?e:yield(r=e,i=t.request,n(void 0,void 0,void 0,(function*(){const e=i.headers.get("Content-Type")?yield i.blob():yield y.resolve(void 0),{method:t,headers:n,referrer:o,referrerPolicy:s,mode:a,credentials:c,cache:u,redirect:d,integrity:l,keepalive:h,signal:p}=i;return new Request(r,{method:t,headers:n,body:e,referrer:o,referrerPolicy:s,mode:a,credentials:c,cache:u,redirect:d,integrity:l,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof f&&(t=e.middlewareControl.getMiddlewareOptions(S)),void 0===t&&(t=Object.assign(new S,this.options)),t}executeWithRedirect(t,r,i){return n(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(t);const n=t.response;if(r<i.maxRedirects&&this.isRedirect(n)&&this.hasLocationHeader(n)&&i.shouldRedirect(n)){if(++r,n.status===P.STATUS_CODE_SEE_OTHER)t.options.method=e.GET,delete t.options.body;else{const e=this.getLocationHeader(n);!this.isRelativeURL(e)&&this.shouldDropAuthorizationHeader(n.url,e)&&delete t.options.headers[P.AUTHORIZATION_HEADER],yield this.updateRequestUrl(e,t)}yield this.executeWithRedirect(t,r,i)}}))}execute(e){return n(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=P.MANUAL_REDIRECT,b.updateFeatureUsageFlag(e,w.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}P.REDIRECT_STATUS_CODES=[301,302,303,307,308],P.STATUS_CODE_SEE_OTHER=303,P.LOCATION_HEADER="Location",P.AUTHORIZATION_HEADER="Authorization",P.MANUAL_REDIRECT="manual";class C{execute(e){return n(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&l(t,e.customHosts)){let t=m(e.request,e.options,C.CLIENT_REQUEST_ID_HEADER);t||(t=(()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e})(),v(e.request,e.options,C.CLIENT_REQUEST_ID_HEADER,t));let r,n=`${C.PRODUCT_NAME}/3.0.7`;if(e.middlewareControl instanceof f&&(r=e.middlewareControl.getMiddlewareOptions(b)),r){const e=r.getFeatureUsage();n+=` (${C.FEATURE_USAGE_STRING}=${e})`}g(e.request,e.options,C.SDK_VERSION_HEADER,n)}else delete e.options.headers[C.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[C.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}C.CLIENT_REQUEST_ID_HEADER="client-request-id",C.SDK_VERSION_HEADER="SdkVersion",C.PRODUCT_NAME="graph-js",C.FEATURE_USAGE_STRING="featureUsage",(_=O||(O={}))[_.MANUAL=0]="MANUAL",_[_.RANDOM=1]="RANDOM",function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(x||(x={}));var L,M,U,N=r(64583).Promise;!function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(L||(L={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(M||(M={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(U||(U={}));class I{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new N(((r,n)=>{e.text().then((e=>{try{const n=(new DOMParser).parseFromString(e,t);r(n)}catch(e){n(e)}}))})):N.resolve(e.body)}static convertResponse(e,t){return n(this,void 0,void 0,(function*(){if(204===e.status)return N.resolve();let r;const n=e.headers.get("Content-type");switch(t){case x.ARRAYBUFFER:r=yield e.arrayBuffer();break;case x.BLOB:r=yield e.blob();break;case x.DOCUMENT:r=yield I.parseDocumentResponse(e,L.TEXT_XML);break;case x.JSON:r=yield e.json();break;case x.STREAM:r=yield N.resolve(e.body);break;case x.TEXT:r=yield e.text();break;default:if(null!==n){const t=n.split(";")[0];r=new RegExp(U.DOCUMENT).test(t)?yield I.parseDocumentResponse(e,t):new RegExp(U.IMAGE).test(t)?e.blob():t===M.TEXT_PLAIN?yield e.text():t===M.APPLICATION_JSON?yield e.json():N.resolve(e.body)}else r=N.resolve(e.body)}return r}))}static getResponse(e,t,r){return n(this,void 0,void 0,(function*(){if(t===x.RAW)return N.resolve(e);{const n=yield I.convertResponse(e,t);if(!e.ok)throw n;if("function"!=typeof r)return n;r(null,n)}}))}}class q{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class F{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new F(e,t.get("location"))}}class j{static createUploadSession(e,t,r,i={}){return n(this,void 0,void 0,(function*(){const n=yield e.api(t).headers(i).post(r);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}}))}constructor(e,t,r,n={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new a("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,n.rangeSize||(n.rangeSize=this.DEFAULT_FILE_SIZE),this.options=n,this.uploadSession=r,this.nextRange=new q(0,this.options.rangeSize-1)}parseRange(e){const t=e[0];if(void 0===t||""===t)return new q;const r=t.split("-"),n=parseInt(r[0],10);let i=parseInt(r[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new q(n,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new q(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new a("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return n(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const r=yield this.file.sliceFile(t),n=yield this.uploadSliceGetRawResponse(r,t,this.file.size);if(!n)throw new a("Something went wrong! Large file upload slice response is null.");const i=yield I.getResponse(n);if(201===n.status||200===n.status&&i.id)return this.reportProgress(e,t),F.CreateUploadResult(i,n.headers);const o={expirationDateTime:i.expirationDateTime||i.ExpirationDateTime,nextExpectedRanges:i.NextExpectedRanges||i.nextExpectedRanges};this.updateTaskStatus(o),this.reportProgress(e,t)}}))}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,r){return n(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,r){return n(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).responseType(x.RAW).put(e)}))}cancel(){return n(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(x.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return n(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return n(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class H{constructor(e,t,r){if(this.content=e,this.name=t,this.size=r,!e||!t||!r)throw new a("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}class k extends j{static constructCreateSessionUrl(e,t=k.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let r,n;if("undefined"!=typeof Blob&&e instanceof Blob)r=new File([e],t),n=r.size;else if("undefined"!=typeof File&&e instanceof File)r=e,n=r.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;n=t.byteLength,r=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:r,size:n}}static create(e,t,r){return n(this,void 0,void 0,(function*(){if(!e||!t||!r)throw new a("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const n=r.fileName,i=k.getFileInfo(t,n),o=new H(i.content,n,i.size);return this.createTaskWithFileObject(e,o,r)}))}static createTaskWithFileObject(e,t,r){return n(this,void 0,void 0,(function*(){if(!e||!t||!r)throw new a("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const n=r.uploadSessionURL?r.uploadSessionURL:k.constructCreateSessionUrl(r.fileName,r.path),i={fileName:r.fileName,fileDescription:r.fileDescription,conflictBehavior:r.conflictBehavior},o=yield k.createUploadSession(e,n,i),s=((e=5242880)=>{const t=62914560;return e>t&&(e=t),(r=e)>327680&&(r=320*Math.floor(r/327680)*1024),r;var r})(r.rangeSize);return new k(e,t,o,{rangeSize:s,uploadEventHandlers:r.uploadEventHandlers})}))}static createUploadSession(e,t,r){const i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return n(this,void 0,void 0,(function*(){const n={item:{"@microsoft.graph.conflictBehavior":(null==r?void 0:r.conflictBehavior)||"rename",name:null==r?void 0:r.fileName,description:null==r?void 0:r.fileDescription}};return i.createUploadSession.call(this,e,t,n)}))}constructor(e,t,r,n){super(e,t,r,n)}commit(e,t="rename"){return n(this,void 0,void 0,(function*(){const r={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(r)}))}}k.DEFAULT_UPLOAD_PATH="/",r(64583).Promise;var $=r(64583).Promise;class Q{constructor(e){this.provider=e}getAccessToken(){return n(this,void 0,void 0,(function*(){return new $(((e,t)=>{this.provider(((r,i)=>n(this,void 0,void 0,(function*(){if(i)e(i);else{r||(r=new a("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield a.setGraphClientError(r);t(e)}}))))}))}))}}class B extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,B.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class X{static constructError(e,t,r){const n=new B(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n.headers=null==r?void 0:r.headers,n}static constructErrorFromResponse(e,t,r){const n=e.error,i=new B(t,n.message);return i.code=n.code,void 0!==n.innerError&&(i.requestId=n.innerError["request-id"],i.date=new Date(n.innerError.date)),i.body=JSON.stringify(n),i.headers=null==r?void 0:r.headers,i}static getError(e=null,t=-1,r,i){return n(this,void 0,void 0,(function*(){let n;if(e&&e.error?n=X.constructErrorFromResponse(e,t,i):e instanceof Error?n=X.constructError(e,t,i):(n=new B(t),n.body=e),"function"!=typeof r)return n;r(n,null)}))}}class V{constructor(e,t,r){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const r=e.substring(t+1,e.length).split("&");for(const e of r)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let n=[];r.length>1&&"string"==typeof t?n=Array.prototype.slice.call(r):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,r)=>{return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==c.indexOf(e)){const r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){var i;return n(this,void 0,void 0,(function*(){let n;const o=new f(this._middlewareOptions);this.updateRequestOptions(t);const s=null===(i=this.config)||void 0===i?void 0:i.customHosts;try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:o,customHosts:s})).response,yield I.getResponse(n,this._responseType,r)}catch(e){if(e instanceof a)throw e;let t;throw n&&(t=n.status),yield X.getError(e,t,r,n)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(t){return n(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),n={method:e.GET};return yield this.send(r,n,t)}))}post(t,r){return n(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),i={method:e.POST,body:u(t)};return"FormData"===(t&&t.constructor&&t.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(n,i,r)}))}create(e,t){return n(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(t,r){return n(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PUT,body:u(t)};return yield this.send(n,i,r)}))}patch(t,r){return n(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PATCH,body:u(t)};return yield this.send(n,i,r)}))}update(e,t){return n(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(t){return n(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),n={method:e.DELETE};return yield this.send(r,n,t)}))}del(e){return n(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(t){return n(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),n={method:e.GET};return this.responseType(x.STREAM),yield this.send(r,n,t)}))}putStream(t,r){return n(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),i={method:e.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};return yield this.send(n,i,r)}))}}class z{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,r)=>{r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}sendRequest(e){return n(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class G{execute(e){return n(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class Y{static createWithAuthenticationProvider(e){const t=new R(e),r=new D(new A),n=new C,i=new G;if(t.setNext(r),"object"==typeof process){const e=new P(new S);r.setNext(e),e.setNext(n)}else r.setNext(n);return n.setNext(i),Y.createWithMiddleware(t)}static createWithMiddleware(...e){return new z(...e)}}var W=r(64583).Promise;class J{static init(e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]="authProvider"===r?new Q(e[r]):e[r]);return J.initWithMiddleware(t)}static initWithMiddleware(e){return new J(e)}constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if(void 0===W&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if(void 0===W){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=Y.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new z(...[].concat(e.middleware))}this.httpClient=t}api(e){return new V(this.httpClient,this.config,e)}}var Z=r(64583).Promise;function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function ee(){ee=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,s=Object.create(o.prototype),a=new P(n||[]);return i(s,"_invoke",{value:x(e,r,a)}),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",p="suspendedYield",f="executing",y="completed",m={};function v(){}function g(){}function E(){}var w={};u(w,s,(function(){return this}));var b=Object.getPrototypeOf,R=b&&b(b(C([])));R&&R!==r&&n.call(R,s)&&(w=R);var A=E.prototype=v.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(i,o,s,a){var c=l(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==K(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function x(t,r,n){var i=h;return function(o,s){if(i===f)throw Error("Generator is already running");if(i===y){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=T(a,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=l(t,r,n);if("normal"===u.type){if(i=n.done?y:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=y,n.method="throw",n.arg=u.arg)}}}function T(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=l(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(K(t)+" is not iterable")}return g.prototype=E,i(A,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:g,configurable:!0}),g.displayName=u(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,u(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},O(_.prototype),u(_.prototype,a,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,i,o){void 0===o&&(o=Z);var s=new _(d(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},O(A),u(A,c,"Generator"),u(A,s,(function(){return this})),u(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function te(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Z.resolve(c).then(n,i)}function re(e){return function(){var t=this,r=arguments;return new Z((function(n,i){var o=e.apply(t,r);function s(e){te(o,n,i,s,a,"next",e)}function a(e){te(o,n,i,s,a,"throw",e)}s(void 0)}))}}function ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ie(n.key),n)}}function ie(e){var t=function(e,t){if("object"!=K(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}Office.onReady();var oe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"getAccessToken",value:(r=re(ee().mark((function e(t){return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Office.auth.getAccessToken({allowConsentPrompt:!0,allowSignInPrompt:!0,forMSGraphAccess:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}],t&&ne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),se=new oe,ae=J.initWithMiddleware({authProvider:se});function ce(){return(ce=re(ee().mark((function e(){var t,r,n,i;return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Claiming Email..."),null!=(t=Office.context.mailbox.item)&&0!=t.internetMessageId.length&&0!=t.itemId.length){e.next=4;break}return e.abrupt("return");case 4:if(r="Claiming email:"+t.internetMessageId,n=Office.context.mailbox.convertToRestId(t.itemId,Office.MailboxEnums.RestVersion.v2_0),!t.getSharedPropertiesAsync){e.next=19;break}return e.prev=7,e.next=10,ae.api("/users/techsupport@sjcd.edu/"+n).update({flag:{flagStatus:"flagged"}});case 10:return e.next=12,ae.api("/users/techsupport@sjcd.edu/"+n+"/forward").post({comment:r,toRecipients:[{emailAddress:{name:"San Jacinto College Tech Support",address:"techsupport@sjcd.edu"}}]});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),console.log(e.t0);case 17:e.next=29;break;case 19:return i={comment:r,toRecipients:[{emailAddress:{name:"Jose Mendez",address:"jose.mendez@sjcd.edu"}}]},e.prev=20,ae.api("/me/messages/"+n).update({flag:{flagStatus:"flagged"}}),e.next=24,ae.api("/me/messages/"+n+"/forward").post(i);case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(20),console.log(e.t1);case 29:console.log("Email successfully claimed!");case 30:case"end":return e.stop()}}),e,null,[[7,14],[20,26]])})))).apply(this,arguments)}Office.actions.associate("claimEmail",(function(){return ce.apply(this,arguments)}))}(),function(){"use strict";var e=r(14385),t=r.n(e),n=new URL(r(98759),r.b);t()(n)}()}();
//# sourceMappingURL=commands.js.map